import{r as m,o as Je,a as Ke,i as Qe,n as Ze,b as Y,j as n,T as W,p as w,c as M,m as ye,d as se,P as z,f as A,e as be,R as we,g as Ce,l as L,u as et,h as Me,s as ie,k as ae,q as P,A as le,$ as tt,t as nt,v as R,w as rt,x as st,y as it,Z as at,z as lt,B as ot,C as ut,D as ct,E as ht,F as dt,G as pt,H as ft,I as oe,J as gt,K as xt,L as mt,M as vt,V as _t,N as jt,O as Se,Q as N,S as Te,_ as y,U as yt,W as bt,X as wt,Y as Ct,a0 as Mt}from"./index-DJrr-S3h.js";var St=Qe?window:null,ke=function(e){return!!e.addEventListener},Be=function(e){return!!e.on},Tt=function(e,t,r,s){r===void 0&&(r=St),m.useEffect(function(){if(t&&r)return ke(r)?Je(r,e,t,s):Be(r)&&r.on(e,t,s),function(){ke(r)?Ke(r,e,t,s):Be(r)&&r.off(e,t,s)}},[e,t,r,JSON.stringify(s)])},kt=function(e){return function(t){return t.key===e}},Bt=function(e,t,r,s){t===void 0&&(t=Ze),r===void 0&&(r={}),s===void 0&&(s=[e]);var i=r.event,o=i===void 0?"keydown":i,u=r.target,c=r.options,d=m.useMemo(function(){var p=kt(e),l=function(f){if(p(f))return t(f)};return l},s);Tt(o,d,u,c)};const Ee={forceUpdateIntervalMs:1500,halfLifeMs:5e3,initMinSamples:5};function Et(e,t){const{forceUpdateIntervalMs:r,halfLifeMs:s,initMinSamples:i}={...Ee,...t},o=m.useMemo(()=>s/Math.log(2),[s]),[u,c]=m.useState(),d=m.useRef(),p=m.useRef(e);p.current=e;const l=m.useRef(),f=m.useRef(0),a=m.useRef(!1);a.current=u!==void 0;const v=m.useCallback(()=>{c(void 0),d.current=void 0,l.current=void 0,f.current=0,_.current!==void 0&&(clearTimeout(_.current),_.current=void 0)},[]),j=m.useCallback(h=>{h??(h=p.current);const x=performance.now();if(d.current===void 0){h!=null&&(d.current={value:h,tsMs:x});return}h??(h=d.current.value);const{value:g,tsMs:b}=d.current,C=x-b;if(!isFinite(C)||C<=0)return;const k=h-g;if(!isFinite(k)||k<0){v();return}if(d.current={value:h,tsMs:x},!a.current&&k>0){if(f.current+=1,!l.current){l.current={value:h,tsMs:x};return}if(f.current<i)return;const S=x-l.current.tsMs,B=(h-l.current.value)/S*1e3;c(B);return}c(S=>{const B=k/C*1e3;if(S===void 0)return B>0?B:S;const E=-Math.expm1(-C/o);return S*(1-E)+B*E})},[i,v,o]),_=m.useRef();return m.useEffect(()=>{if(_.current!==void 0&&(clearTimeout(_.current),_.current=void 0),j(e),r!==void 0){let h=function(){_.current=setTimeout(()=>{j(),h()},r)};h()}return()=>{_.current!==void 0&&(clearTimeout(_.current),_.current=void 0)}},[r,j,e]),{ema:u,reset:v}}function T(e,t=Ee){return Et(e,t).ema??0}function V({inBytes:e,value:t}){const r=T(t)??0,s=r!==void 0?e?Y(r).toString():Math.trunc(r).toLocaleString():"-";return n.jsx(W,{align:"right",children:s})}const J=["ContactInfoV1","Vote","LowestSlot","SnapshotHashes","AccountsHashes","EpochSlots","VersionV1","VersionV2","NodeInstance","DuplicateShred","IncrementalSnapshotHashes","ContactInfoV2","RestartLastVotedForkSlots","RestartHeaviestFork"],At=["pull_request","pull_response","push","ping","pong","prune"],ue="30px",I="10px",ce="160px",Ae="10px",Fe=`repeat(auto-fill, minmax(${ce}, 1fr)`,Le="44px",K="200px",Q="320px",Ft="_header-text_n52ov_1",Lt="_storage-stats-container_n52ov_6",Rt="_root_n52ov_11",$={headerText:Ft,storageStatsContainer:Lt,root:Rt};function Nt({storage:e}){const t=m.useMemo(()=>{if(e!=null&&e.count)return e.count.map((r,s)=>{var i,o,u;return{type:J[s],activeEntries:(i=e.count)==null?void 0:i[s],egressCount:(o=e.count_tx)==null?void 0:o[s],egressBytes:(u=e.bytes_tx)==null?void 0:u[s]}}).sort((r,s)=>s.activeEntries-r.activeEntries)},[e]);if(t)return n.jsxs(w,{className:$.storageStatsContainer,direction:"column",gap:I,minWidth:Q,height:"100%",minHeight:"250px",children:[n.jsx(M,{className:$.headerText,children:"Storage Stats"}),n.jsxs(ye,{variant:"surface",className:$.root,size:"1",children:[n.jsx(se,{children:n.jsxs(z,{children:[n.jsx(A,{children:"Entry Type"}),n.jsx(A,{align:"right",children:"Total Entries"}),n.jsx(A,{align:"right",children:"Egress /s"}),n.jsx(A,{align:"right",children:"Egress Throughput /s"})]})}),n.jsx(be,{children:t==null?void 0:t.map(r=>n.jsxs(z,{children:[n.jsx(we,{children:r.type}),n.jsx(W,{align:"right",children:r.activeEntries.toLocaleString()}),n.jsx(V,{value:r.egressCount??0}),n.jsx(V,{value:r.egressBytes??0,inBytes:!0})]},r.type))})]})]})}const It="_label_1nl74_1",Ot="_value_1nl74_6",Re={label:It,value:Ot};function F(e){return n.jsx(Ce,{children:n.jsx(zt,{...e})})}function zt({value:e,label:t,valueColor:r}){const s=typeof e=="string"?e:e.toLocaleString();return n.jsxs(w,{direction:"column",minWidth:"0",gap:"10px",children:[n.jsx(M,{className:Re.label,children:t}),n.jsx(M,{className:Re.value,style:r?{color:r}:void 0,children:s})]})}function Pt({storage:e}){var u;const t=m.useMemo(()=>{if(e!=null&&e.count)return e.count.map((c,d)=>{var p,l,f;return{type:J[d],activeEntries:(p=e.count)==null?void 0:p[d],egressCount:(l=e.count_tx)==null?void 0:l[d],egressBytes:(f=e.bytes_tx)==null?void 0:f[d]}})},[e]),r=m.useMemo(()=>{const c=L.sum(e.count),d=e.capacity-c;return`${Math.round(c/d*100)}%`},[e.capacity,e.count]),s=et(e.expired_count,1e4),i=m.useRef([]);m.useMemo(()=>{i.current.push({ts:performance.now(),value:e.expired_count})},[e.expired_count]),Me(()=>{const c=performance.now();for(;i.current.length>1&&c-i.current[0].ts>6e4;)i.current.shift()},1e3);const o=e.expired_count-(((u=i.current[0])==null?void 0:u.value)??0);if(t)return n.jsxs(w,{direction:"column",gap:I,children:[n.jsx(M,{className:ie.headerText,children:"Storage Stats"}),n.jsxs(w,{gap:Le,wrap:"wrap",children:[n.jsxs(ae,{columns:Fe,minWidth:ce,gap:Ae,flexGrow:"1",flexBasis:"0",children:[n.jsx(F,{label:"Expired (/s)",value:`${Math.trunc(s.valuePerSecond??0)}`}),n.jsx(F,{label:"Expired (Last Min)",value:`${o.toLocaleString()}`}),n.jsx(F,{label:"Total Evicted",value:e.evicted_count}),n.jsx(F,{label:"Capacity Used",value:r})]}),n.jsx(P,{minWidth:K,minHeight:K,flexGrow:"1",flexBasis:"0",children:n.jsx(qt,{storage:e,usedCapacity:r})})]})]})}const Ne=["#48295C","#562800","#132D21"],Vt=e=>Ne[e%Ne.length];function qt({storage:e,usedCapacity:t}){const r=m.useMemo(()=>{const s=L.sum(e.count);return[{id:"unused",label:"Unused",value:e.capacity-s,color:"#222"},...e.count.map((i,o)=>({id:J[o]+o,label:J[o],value:i})).sort((i,o)=>o.value-i.value).map((i,o)=>({...i,color:Vt(o)}))]},[e]);return n.jsx(le,{children:({height:s,width:i})=>n.jsx(tt,{height:s,width:i,data:r,colors:o=>o.data.color,arcLabelsSkipAngle:10,arcLinkLabelsSkipAngle:10,arcLabelsTextColor:"#9F9F9F",enableArcLinkLabels:!1,layers:["arcs","arcLabels",Wt(t)],tooltip:$t,animate:!1,innerRadius:.7,arcLabel:o=>o.data.label})})}function Wt(e){return function({dataWithArc:t,centerX:r,centerY:s}){return n.jsx("text",{y:s-6,textAnchor:"middle",dominantBaseline:"central",style:{fontSize:"28px",fill:"#9F9F9F"},children:n.jsx("tspan",{x:r,dy:5,children:e})})}}function $t(e){const t=e.datum.value;return n.jsx("div",{className:ie.tooltip,children:n.jsxs(M,{style:{whiteSpace:"nowrap"},children:[e.datum.label,":\xA0",t]})})}function Dt({messages:e}){const t=m.useMemo(()=>e.num_bytes_rx.map((r,s)=>{var i,o,u,c;return{type:At[s],ingressBytes:(i=e.num_bytes_rx)==null?void 0:i[s],egressBytes:(o=e.num_bytes_tx)==null?void 0:o[s],ingressMessages:(u=e.num_messages_rx)==null?void 0:u[s],egressMessages:(c=e.num_messages_tx)==null?void 0:c[s]}}),[e]);if(t)return n.jsxs(w,{direction:"column",gap:I,minWidth:Q,children:[n.jsx(M,{className:$.headerText,children:"Message Stats"}),n.jsxs(ye,{variant:"surface",className:$.root,size:"1",children:[n.jsx(se,{children:n.jsxs(z,{children:[n.jsx(A,{children:"Message Type"}),n.jsx(A,{align:"right",children:"Ingress /s"}),n.jsx(A,{align:"right",children:"Egress /s"}),n.jsx(A,{align:"right",children:"Ingress Throughput /s"}),n.jsx(A,{align:"right",children:"Egress Throughput /s"})]})}),n.jsx(be,{children:t==null?void 0:t.map((r,s)=>n.jsxs(z,{children:[n.jsx(we,{children:r.type}),n.jsx(V,{value:r.ingressMessages??0}),n.jsx(V,{value:r.egressMessages??0}),n.jsx(V,{value:r.ingressBytes??0,inBytes:!0}),n.jsx(V,{value:r.egressBytes??0,inBytes:!0})]},r.type))})]})]})}const Ie={id:"Stake",direction:-1};function Gt(){const e=nt(),t=R(rt),r=R(st),s=m.useRef(new Map),[i,o]=m.useState([]),[u,c]=m.useState(Ie);m.useEffect(()=>{var f;if(!t)return;const l=Object.entries(t);if(!i.length&&((f=l[0])!=null&&f[1])){const a=Object.keys(l[0][1]);o(a),c(Ie)}for(const[a,v]of l)s.current.set(a,v)},[i,t]),m.useEffect(()=>{if(r)for(const l of r.changes){const f=s.current.get(l.row_index.toString());f&&(f[l.column_name]=l.new_value)}},[r]);const d=m.useCallback((l,f)=>{if(f<l||l<0)return;const a={start_row:l,row_cnt:f-l};e({topic:"gossip",key:"query_scroll",id:16,params:a})},[e]),p=m.useCallback(l=>{(i==null?void 0:i.indexOf(l))!==void 0&&c(f=>{let a=-1;f.id===l&&(a=-f.direction);const v=i.filter(h=>h!==l),j=new Array(v.length).fill(0),_={col:[l,...v],dir:[a,...j]};return e({topic:"gossip",key:"query_sort",id:32,params:_}),{id:l,direction:a}})},[i,e]);return{query:d,sort:p,colIds:i,rowsCacheRef:s,colSorting:u}}const Ht="_header-text_1ozln_1",Ut="_peer-table_1ozln_6",Xt="_header-cell_1ozln_22",Yt="_header-separator_1ozln_26",Z={headerText:Ht,peerTable:Ut,headerCell:Xt,headerSeparator:Yt},Jt=1e3,he=0,ee=e=>{if(typeof e=="number"){const t=Y(e);return`${t.value} ${t.unit}`}return e},Kt={Stake:{width:80,align:"right",format:e=>typeof e=="number"?Math.abs(Math.trunc(e/dt)).toLocaleString():e},Pubkey:{width:200},Name:{width:160},Country:{width:80},"IP Addr":{width:80},"Ingress Pull":{width:80,align:"right",format:ee},"Ingress Push":{width:80,align:"right",format:ee},"Egress Pull":{width:80,align:"right",format:ee},"Egress Push":{width:80,align:"right",format:ee}},te={width:150};function D(e){return Kt[e]??te}function Qt(){const e=R(it)??Jt,{query:t,sort:r,colIds:s,rowsCacheRef:i,colSorting:o}=Gt(),[u,c]=m.useState(()=>({row:-1,colId:""})),[d,p]=m.useState(!1),[l,f]=m.useState(Object.fromEntries(s.map(h=>[h,D(h).width??te.width])));m.useEffect(()=>{f(Object.fromEntries(s.map(h=>[h,D(h).width??te.width])))},[s]);const a=m.useCallback(({startIndex:h,endIndex:x})=>{const g=Math.max(0,h-he),b=Math.min(x+he,e>0?e-1:x+he);t(g,b)},[t,e]),v=m.useMemo(()=>Zt(s,l),[s,l]),j=m.useRef(u);j.current=u,Bt("c",h=>{var x,g;if(h.ctrlKey){const b=(g=(x=i.current)==null?void 0:x.get(j.current.row.toString()))==null?void 0:g[j.current.colId];b&&(pt(b.toString()),p(!0),setTimeout(()=>{p(!1)},500))}});const _=m.useCallback((h,x)=>{f(g=>({...g,[h]:Math.max(x,D(h).width??te.width)}))},[]);return n.jsxs(w,{direction:"column",gap:I,flexGrow:"1",children:[n.jsx(M,{className:Z.headerText,children:"Peers"}),n.jsx(P,{flexGrow:"1",minHeight:"300px",asChild:!0,children:n.jsx(at,{className:lt("rt-TableRoot","rt-r-size-1","rt-variant-surface",Z.peerTable),totalCount:e,increaseViewportBy:200,rangeChanged:a,components:v,itemContent:h=>{var g;const x=(g=i.current)==null?void 0:g.get(h.toString());return x?s.map(b=>{const C=D(b),k=C.align,S=C.format,B=x==null?void 0:x[b],E=u.row===h&&u.colId===b;return n.jsx(W,{align:k,onClick:()=>c({row:h,colId:b}),style:{outline:E?`1px dashed var(--gray-${d?11:10})`:"none",outlineOffset:-2},children:n.jsx(M,{truncate:!0,as:"div",children:S?S(B):B})},b)}):s!=null&&s.length?n.jsx(n.Fragment,{children:s.map(b=>n.jsx(W,{children:"\xA0"},b))}):n.jsx(n.Fragment,{children:n.jsx(W,{children:"&nsbsp;"})})},fixedHeaderContent:()=>n.jsx(z,{children:s.map(h=>{const{align:x}=D(h),g=o.id===h?o.direction:void 0,b=C=>{C.preventDefault();const k=C.clientX,S=l[h],B=q=>_(h,S+(q.clientX-k)),E=()=>{window.removeEventListener("pointermove",B),window.removeEventListener("pointerup",E)};window.addEventListener("pointermove",B),window.addEventListener("pointerup",E)};return n.jsx(A,{align:x,p:"0",children:n.jsxs(w,{align:"center",height:"100%",children:[n.jsx(ot,{children:n.jsx(P,{flexGrow:"1",className:Z.headerCell,asChild:!0,children:n.jsx("button",{onClick:()=>r(h),children:n.jsxs(w,{align:"center",gap:"1",justify:x==="right"?"end":"start",children:[x==="right"&&n.jsx(Oe,{direction:g}),n.jsx(M,{truncate:!0,title:h,as:"div",children:h}),x!=="right"&&n.jsx(Oe,{direction:g})]})})})}),n.jsx("div",{style:{paddingLeft:"8px",paddingRight:"2px",cursor:"col-resize"},onPointerDown:b,children:n.jsx(ut,{orientation:"vertical",size:"2",className:Z.headerSeparator})})]})},h)})})})})]})}function Oe({direction:e}){return n.jsxs(n.Fragment,{children:[e===-1&&n.jsx(ct,{height:12,width:12}),e===1&&n.jsx(ht,{height:12,width:12})]})}function Zt(e,t){return{Table:r=>n.jsxs("table",{...r,className:"rt-TableRootTable",style:{...r.style,overflow:"inherit",tableLayout:"fixed"},children:[n.jsx("colgroup",{children:e.map(s=>n.jsx("col",{style:{width:t[s]}},s))}),r.children]}),TableHead:r=>n.jsx(se,{...r,style:{...r.style,background:"#0e131c"}}),TableRow:r=>n.jsx(z,{...r})}}function en(){{const e=R(ft);if(!e)return null;const t=oe(e.activeStake),r=oe(e.delinquentStake);return n.jsxs(w,{direction:"column",gap:I,children:[n.jsx(M,{className:ie.headerText,children:"Validator Stats"}),n.jsxs(w,{gap:Le,wrap:"wrap",children:[n.jsxs(ae,{columns:Fe,minWidth:ce,gap:Ae,flexGrow:"1",flexBasis:"0",children:[n.jsx(F,{label:"Total Validators",value:e.validatorCount.toLocaleString(),valueColor:gt}),n.jsx(F,{label:"Non-delinquent Stake",value:t,valueColor:xt}),n.jsx(F,{label:"RPC Nodes",value:e.rpcCount.toLocaleString(),valueColor:mt}),n.jsx(F,{label:"Delinquent Stake",value:r,valueColor:vt})]}),n.jsx(P,{minWidth:K,minHeight:K,flexGrow:"1",flexBasis:"0",children:n.jsx(_t,{activeStake:e.activeStake,delinquentStake:e.delinquentStake})})]})]})}}const ze=150,tn=3e4,de=Math.trunc(tn/ze),pe=2;function Pe({values:e,colors:t,maxValue:r}){const s=m.useRef(),[i,o]=m.useState([]),u=e.length,c=m.useRef(r);c.current=r;const d=m.useRef(!1);m.useEffect(()=>{o(Array.from({length:de}).map((l,f)=>Array.from({length:u})))},[u]),Me(()=>{!d.current&&e.every(l=>!l)||(d.current=!0,o(l=>{let f=[...l];return l.length>de&&(f=f.slice(f.length-de)),f.push(e),f}))},ze);const p=m.useMemo(()=>{var x;if(!s.current||!i.length)return;const{height:l,width:f}=s.current;if(l<0||f<0)return;const a=i.length,v=f/a,j=Math.max(c.current,Math.max(...i.flatMap(g=>g.filter(jt)))),_=i[0].length,h=Array.from({length:_}).map(()=>new Array);for(let g=0;g<i.length;g++)for(let b=0;b<i[g].length;b++){const C=i[g][b];C!==void 0&&h[b].push({x:g*v,y:(1-C/j)*(l-pe)+pe/2})}if(((x=h[0])==null?void 0:x.length)!==0)return h.map(g=>g.map(({x:b,y:C})=>`${b},${C}`).join(" "))},[i]);return n.jsx(P,{flexGrow:"1",minHeight:"80px",children:n.jsx(le,{children:({height:l,width:f})=>{if(s.current={height:l,width:f},!!p&&(p==null?void 0:p.length)===t.length)return n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:f,height:l,style:{background:"#222222"},children:p.map((a,v)=>n.jsx("polyline",{points:a,stroke:t[v],strokeWidth:pe,fill:"none",strokeLinecap:"round",strokeOpacity:.8},t[v]))})}})})}const fe="#197CAE",ge="var(--amber-8)",Ve="#CBD4D6",qe=[fe,ge];function nn({health:e}){return n.jsxs(ae,{columns:{initial:"1",sm:"2",lg:"4"},gapY:"3",gapX:"7",children:[n.jsx(sn,{health:e}),n.jsx(rn,{health:e}),n.jsx(an,{health:e}),n.jsx(ln,{health:e})]})}function We({title:e,children:t}){return n.jsxs(w,{direction:"column",gap:I,children:[n.jsx(M,{style:{color:"var(--primary-text-color)",fontSize:"18px"},children:e}),n.jsx(Ce,{style:{flex:1},children:t})]})}function $e({value:e,label:t,valueColor:r,pct:s}){return n.jsxs(w,{direction:"column",children:[n.jsxs(w,{gap:"2",children:[n.jsx(M,{style:{color:"var(--gray-11)"},children:t}),n.jsxs(M,{style:{color:"var(--gray-10)"},children:[Se.format(s*100),"%"]})]}),n.jsx(M,{style:{color:r},size:"8",children:Math.round(e).toLocaleString()})]})}function xe({value:e,label:t,valueColor:r,pct:s,size:i}){return n.jsxs(w,{direction:"column",children:[n.jsx(M,{style:{color:"var(--gray-11)"},children:t}),n.jsx(M,{style:{color:r},size:i==="lg"?"8":"6",children:Math.round(e).toLocaleString()}),s!==void 0&&n.jsxs(M,{style:{color:"var(--gray-10)"},size:"2",children:[Se.format(s*100),"%"]})]})}function rn({health:e}){const t=T(e.num_push_entries_rx_success+e.num_push_entries_rx_failure),r=T(e.num_pull_response_entries_rx_success+e.num_pull_response_entries_rx_failure),s=T(e.num_push_entries_rx_success),i=T(e.num_pull_response_entries_rx_success),o=s+i,u=Math.max(t,r,o),c=L.clamp(s/t,0,1),d=L.clamp(i/r,0,1),p=[Ve,...qe];return n.jsx(We,{title:"Entries Success /s",children:n.jsxs(w,{gap:"6",children:[n.jsxs(w,{direction:"column",gap:"3",children:[n.jsx(xe,{label:"Total",value:o,valueColor:Ve,size:"lg"}),n.jsxs(w,{gap:"3",children:[n.jsx(xe,{label:"Push",value:s,valueColor:fe,pct:c}),n.jsx(xe,{label:"Pull",value:i,valueColor:ge,pct:d})]})]}),n.jsx(Pe,{values:[o,s,i],colors:p,maxValue:u})]})})}function me({title:e,valueA:t,valueB:r,totalA:s,totalB:i,labelA:o,labelB:u}){const c=t/s,d=r/i,p=Math.max(s,i);return n.jsx(We,{title:e,children:n.jsxs(w,{gap:"6",height:"100%",children:[n.jsxs(w,{direction:"column",gap:"3",minWidth:"120px",children:[n.jsx($e,{label:o,value:t,valueColor:fe,pct:L.clamp(c,0,1)}),n.jsx($e,{label:u,value:r,valueColor:ge,pct:L.clamp(d,0,1)})]}),n.jsx(Pe,{values:[t,r],colors:qe,maxValue:p})]})})}function sn({health:e}){const t=T(e.num_push_messages_rx_success+e.num_push_messages_rx_failure),r=T(e.num_pull_response_messages_rx_success+e.num_pull_response_messages_rx_failure),s=T(e.num_push_messages_rx_failure),i=T(e.num_pull_response_messages_rx_failure);return n.jsx(me,{title:"Message Failures /s",valueA:s,valueB:i,totalA:t,totalB:r,labelA:"Push",labelB:"Pull"})}function an({health:e}){const t=T(e.num_push_entries_rx_success+e.num_push_entries_rx_failure),r=T(e.num_pull_response_entries_rx_success+e.num_pull_response_entries_rx_failure),s=T(e.num_push_entries_rx_duplicate),i=T(e.num_pull_response_entries_rx_duplicate);return n.jsx(me,{title:"Entry Duplicates /s",valueA:s,valueB:i,totalA:t,totalB:r,labelA:"Push",labelB:"Pull"})}function ln({health:e}){const t=T(e.num_push_entries_rx_success+e.num_push_entries_rx_failure),r=T(e.num_pull_response_entries_rx_success+e.num_pull_response_entries_rx_failure),s=T(e.num_push_entries_rx_failure-e.num_push_entries_rx_duplicate),i=T(e.num_pull_response_entries_rx_failure-e.num_pull_response_entries_rx_duplicate);return n.jsx(me,{title:"Entry Failures /s",valueA:s,valueB:i,totalA:t,totalB:r,labelA:"Push",labelB:"Pull"})}var on=["top","left","transform","className","children","innerRef"];function ve(){return ve=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},ve.apply(this,arguments)}function un(e,t){if(e==null)return{};var r={},s=Object.keys(e),i,o;for(o=0;o<s.length;o++)i=s[o],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function G(e){var t=e.top,r=t===void 0?0:t,s=e.left,i=s===void 0?0:s,o=e.transform,u=e.className,c=e.children,d=e.innerRef,p=un(e,on);return N.createElement("g",ve({ref:d,className:Te("visx-group",u),transform:o||"translate("+i+", "+r+")"},p),c)}G.propTypes={top:y.number,left:y.number,transform:y.string,className:y.string,children:y.node,innerRef:y.oneOfType([y.string,y.func,y.object])};function cn(e){var t=0,r=e.children,s=r&&r.length;if(!s)t=1;else for(;--s>=0;)t+=r[s].value;e.value=t}function hn(){return this.eachAfter(cn)}function dn(e){var t=this,r,s=[t],i,o,u;do for(r=s.reverse(),s=[];t=r.pop();)if(e(t),i=t.children,i)for(o=0,u=i.length;o<u;++o)s.push(i[o]);while(s.length);return this}function pn(e){for(var t=this,r=[t],s,i;t=r.pop();)if(e(t),s=t.children,s)for(i=s.length-1;i>=0;--i)r.push(s[i]);return this}function fn(e){for(var t=this,r=[t],s=[],i,o,u;t=r.pop();)if(s.push(t),i=t.children,i)for(o=0,u=i.length;o<u;++o)r.push(i[o]);for(;t=s.pop();)e(t);return this}function gn(e){return this.eachAfter(function(t){for(var r=+e(t.data)||0,s=t.children,i=s&&s.length;--i>=0;)r+=s[i].value;t.value=r})}function xn(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function mn(e){for(var t=this,r=vn(t,e),s=[t];t!==r;)t=t.parent,s.push(t);for(var i=s.length;e!==r;)s.splice(i,0,e),e=e.parent;return s}function vn(e,t){if(e===t)return e;var r=e.ancestors(),s=t.ancestors(),i=null;for(e=r.pop(),t=s.pop();e===t;)i=e,e=r.pop(),t=s.pop();return i}function _n(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function jn(){var e=[];return this.each(function(t){e.push(t)}),e}function yn(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function bn(){var e=this,t=[];return e.each(function(r){r!==e&&t.push({source:r.parent,target:r})}),t}function _e(e,t){var r=new ne(e),s=+e.value&&(r.value=e.value),i,o=[r],u,c,d,p;for(t==null&&(t=Cn);i=o.pop();)if(s&&(i.value=+i.data.value),(c=t(i.data))&&(p=c.length))for(i.children=new Array(p),d=p-1;d>=0;--d)o.push(u=i.children[d]=new ne(c[d])),u.parent=i,u.depth=i.depth+1;return r.eachBefore(Sn)}function wn(){return _e(this).eachBefore(Mn)}function Cn(e){return e.children}function Mn(e){e.data=e.data.data}function Sn(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function ne(e){this.data=e,this.depth=this.height=0,this.parent=null}ne.prototype=_e.prototype={constructor:ne,count:hn,each:dn,eachAfter:fn,eachBefore:pn,sum:gn,sort:xn,path:mn,ancestors:_n,descendants:jn,leaves:yn,links:bn,copy:wn};function Tn(e){if(typeof e!="function")throw new Error;return e}function H(){return 0}function U(e){return function(){return e}}function kn(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function Bn(e,t,r,s,i){for(var o=e.children,u,c=-1,d=o.length,p=e.value&&(s-t)/e.value;++c<d;)u=o[c],u.y0=r,u.y1=i,u.x0=t,u.x1=t+=u.value*p}function En(e,t,r,s,i){for(var o=e.children,u,c=-1,d=o.length,p=e.value&&(i-r)/e.value;++c<d;)u=o[c],u.x0=t,u.x1=s,u.y0=r,u.y1=r+=u.value*p}var An=(1+Math.sqrt(5))/2;function Fn(e,t,r,s,i,o){for(var u=[],c=t.children,d,p,l=0,f=0,a=c.length,v,j,_=t.value,h,x,g,b,C,k,S;l<a;){v=i-r,j=o-s;do h=c[f++].value;while(!h&&f<a);for(x=g=h,k=Math.max(j/v,v/j)/(_*e),S=h*h*k,C=Math.max(g/S,S/x);f<a;++f){if(h+=p=c[f].value,p<x&&(x=p),p>g&&(g=p),S=h*h*k,b=Math.max(g/S,S/x),b>C){h-=p;break}C=b}u.push(d={value:h,dice:v<j,children:c.slice(l,f)}),d.dice?Bn(d,r,s,i,_?s+=j*h/_:o):En(d,r,s,_?r+=v*h/_:i,o),_-=h,l=f}return u}const De=function e(t){function r(s,i,o,u,c){Fn(t,s,i,o,u,c)}return r.ratio=function(s){return e((s=+s)>1?s:1)},r}(An);function Ln(){var e=De,t=!1,r=1,s=1,i=[0],o=H,u=H,c=H,d=H,p=H;function l(a){return a.x0=a.y0=0,a.x1=r,a.y1=s,a.eachBefore(f),i=[0],t&&a.eachBefore(kn),a}function f(a){var v=i[a.depth],j=a.x0+v,_=a.y0+v,h=a.x1-v,x=a.y1-v;h<j&&(j=h=(j+h)/2),x<_&&(_=x=(_+x)/2),a.x0=j,a.y0=_,a.x1=h,a.y1=x,a.children&&(v=i[a.depth+1]=o(a)/2,j+=p(a)-v,_+=u(a)-v,h-=c(a)-v,x-=d(a)-v,h<j&&(j=h=(j+h)/2),x<_&&(_=x=(_+x)/2),e(a,j,_,h,x))}return l.round=function(a){return arguments.length?(t=!!a,l):t},l.size=function(a){return arguments.length?(r=+a[0],s=+a[1],l):[r,s]},l.tile=function(a){return arguments.length?(e=Tn(a),l):e},l.padding=function(a){return arguments.length?l.paddingInner(a).paddingOuter(a):l.paddingInner()},l.paddingInner=function(a){return arguments.length?(o=typeof a=="function"?a:U(+a),l):o},l.paddingOuter=function(a){return arguments.length?l.paddingTop(a).paddingRight(a).paddingBottom(a).paddingLeft(a):l.paddingTop()},l.paddingTop=function(a){return arguments.length?(u=typeof a=="function"?a:U(+a),l):u},l.paddingRight=function(a){return arguments.length?(c=typeof a=="function"?a:U(+a),l):c},l.paddingBottom=function(a){return arguments.length?(d=typeof a=="function"?a:U(+a),l):d},l.paddingLeft=function(a){return arguments.length?(p=typeof a=="function"?a:U(+a),l):p},l}function Ge(e){var t=e.node,r=t.x0,s=t.x1,i=t.y0,o=t.y1;return N.createElement("rect",{x:r,y:i,width:Math.abs(s-r),height:Math.abs(o-i),fill:"#21D4FD"})}Ge.propTypes={node:y.shape({x0:y.number.isRequired,x1:y.number.isRequired,y0:y.number.isRequired,y1:y.number.isRequired}).isRequired};function O(e,t){e(t)}function He(e){var t=e.top,r=e.left,s=e.className,i=e.root,o=e.tile,u=e.size,c=e.round,d=e.padding,p=e.paddingInner,l=e.paddingOuter,f=e.paddingTop,a=e.paddingRight,v=e.paddingBottom,j=e.paddingLeft,_=e.children,h=e.nodeComponent,x=h===void 0?Ge:h,g=Ln();o&&g.tile(o),u&&g.size(u),c&&g.round(c),d&&O(g.padding,d),p&&O(g.paddingInner,p),l&&O(g.paddingOuter,l),f&&O(g.paddingTop,f),a&&O(g.paddingRight,a),v&&O(g.paddingBottom,v),j&&O(g.paddingLeft,j);var b=g(i);return _?N.createElement(N.Fragment,null,_(b)):N.createElement(G,{top:t,left:r,className:Te("visx-treemap",s)},x&&b.descendants().map(function(C,k){return N.createElement(G,{key:"treemap-node-"+k},N.createElement(x,{node:C}))}))}He.propTypes={children:y.func,top:y.number,left:y.number,className:y.string,round:y.bool,padding:y.oneOfType([y.number,y.func]),paddingInner:y.oneOfType([y.number,y.func]),paddingOuter:y.oneOfType([y.number,y.func]),paddingTop:y.oneOfType([y.number,y.func]),paddingRight:y.oneOfType([y.number,y.func]),paddingBottom:y.oneOfType([y.number,y.func]),paddingLeft:y.oneOfType([y.number,y.func])};const Rn="_header-text_oj2nf_1",Nn="_total-text_oj2nf_6",In="_throughput-text_oj2nf_11",je={headerText:Rn,totalText:Nn,throughputText:In},Ue=["#00F0FF","#00B5FF","#5BFFFF","#00FFD1","#0EEAD5","#D9F8FF"];function Xe({networkTraffic:e,label:t,includeAll:r=!1}){const s=R(yt),i=m.useMemo(()=>{var f,a;if(!e.peer_throughput)return;const u=.7;let c=0,d=0;const p=[];for(;d<e.peer_throughput.length&&c*u<(e.total_throughput??0);){const v=((f=e.peer_names)==null?void 0:f[d])||((a=e.peer_identities)==null?void 0:a[d])||"",j=Ue[Math.trunc(Math.random()*Ue.length)];p.push({id:v,value:e.peer_throughput[d],color:j}),c+=e.peer_throughput[d],d++}let l=0;for(d;d<e.peer_throughput.length;d++)l+=e.peer_throughput[d];return p.push({id:"rest",value:r?(e.total_throughput??0)-c:l,color:"#1CE7C2"}),{id:"peers",children:p,color:void 0,value:e.total_throughput}},[r,e]),o=m.useCallback(u=>{var a,v,j;const c=s[u];if(!c)return;const d=L.sum(c.vote.map(_=>_.delinquent?0:Number(_.activated_stake))),p=d?`${oe(d)} SOL`:void 0,l=((a=c.info)==null?void 0:a.icon_url)||((v=c.info)!=null&&v.keybase_username?`https://keybase.io/${c.info.keybase_username}/picture`:void 0)||void 0,f=((j=c.info)==null?void 0:j.name)??void 0;return{stake:p,iconUrl:l,name:f}},[s]);if(i)return n.jsxs(w,{direction:"column",gap:I,minHeight:"300px",minWidth:"300px",flexGrow:"1",children:[n.jsxs(w,{justify:"between",children:[n.jsx(M,{className:je.headerText,children:t}),n.jsxs("span",{children:[n.jsx(M,{className:je.totalText,children:"Total"}),n.jsxs(M,{className:je.throughputText,children:["\xA0",Y(e.total_throughput).toString(),"/s"]})]})]}),n.jsx(P,{flexGrow:"1",children:n.jsx(le,{children:({height:u,width:c})=>n.jsx(qn,{data:i,width:c,height:u,getPeerValues:o})})})]})}const X=(()=>{let e=null,t=null;return(r,s)=>(e||(e=document.createElement("canvas")),t||(t=e.getContext("2d")),t?(t.font=s,t.measureText(r).width):r.length*7)})();function On(e,t,r){if(X(e,t)<=r)return e;const s="\u2026";if(X(s,t)>r)return"";let i=0,o=e.length;for(;i<o;){const u=Math.ceil((i+o)/2),c=e.slice(0,u)+s;X(c,t)<=r?i=u:o=u-1}return e.slice(0,i)+s}const Ye=55,zn=40,Pn=8,Vn=2;function qn({data:e,width:t,height:r,colors:s,getPeerValues:i}){const o=m.useMemo(()=>e.children.reduce((p,l)=>p+(l.value||0),0),[e]),u=m.useMemo(()=>_e({name:e.id,children:e.children.map(p=>({name:p.id,value:p.value}))}).sum(p=>p.value||0).sort((p,l)=>(l.value||0)-(p.value||0)),[e]),c=m.useMemo(()=>{const p=s??["#48295C","#562800","#132D21","#331E0B","#0D2847","#292929"];return bt().domain(e.children.map(l=>l.id)).range(p)},[e,s]),d=m.useMemo(()=>De.ratio(1.1),[]);return n.jsx("svg",{width:t,height:r,children:n.jsx(He,{root:u,size:[t,r],tile:d,round:!0,paddingInner:2,children:p=>n.jsx(G,{children:p.leaves().map(l=>{const f=l.x0,a=l.y0,v=l.x1-l.x0,j=l.y1-l.y0,_=String(l.data.name);return n.jsxs(G,{children:[n.jsx("rect",{x:f,y:a,width:v,height:j,rx:1,ry:1,fill:c(_)}),n.jsx(Wn,{leaf:l,total:o,getPeerValues:i})]},_)})})})})}function Wn({leaf:e,total:t,getPeerValues:r}){const s=e.x0,i=e.y0,o=e.x1-e.x0,u=e.y1-e.y0,c=String(e.data.name),d=t>0?100*(e.value||0)/t:0,p=o>=Ye&&u>=zn,l=u>30*2,f=Math.max(11,Math.min(16,Math.floor(o/12))),a=r(c),v=`${f}px Inter Tight`,j=s+o/2,_=f+Vn,h=i+u/3,x=2,g=f+4,b=Math.max(0,o-2*Pn-(g?g+x:0)),C=On((a==null?void 0:a.name)??c,v,b),k=X(C,v),S=(g?g+x:0)+k,B=j-S/2,E=h,q=Y(e.value??0);let re=`${q?`${q.toString()} `:""}(${d.toFixed(1)}%)`;if(X(re,v)<b||(re=`${q.toString()}`),!(o<Ye))return n.jsxs(n.Fragment,{children:[a!=null&&a.iconUrl?n.jsxs(n.Fragment,{children:["(",n.jsx("image",{href:a.iconUrl,x:B,y:E,width:g,height:g,preserveAspectRatio:"xMidYMid meet",crossOrigin:"anonymous"}),n.jsx("text",{x:B+g+x,y:E,fontSize:f,alignmentBaseline:"text-before-edge",fontFamily:"Inter Tight",fontWeight:600,fill:"#CCCCCC",textAnchor:"start",pointerEvents:"none",children:C}),")"]}):n.jsx("text",{x:j,y:E,fontSize:f,fontFamily:"Inter Tight",fontWeight:600,fill:"#CCCCCC",alignmentBaseline:"text-before-edge",textAnchor:"middle",pointerEvents:"none",children:C}),p&&n.jsx(n.Fragment,{children:n.jsxs("text",{x:j,y:E+12,fontSize:f,fontFamily:"Inter Tight",fill:"#CCCCCC",pointerEvents:"none",alignmentBaseline:"text-before-edge",textAnchor:"middle",children:[n.jsx("tspan",{x:j,dy:_,fill:"#8A8A8A",children:re}),l&&n.jsx("tspan",{x:j,dy:_,fill:"#8A8A8A",children:a==null?void 0:a.stake})]})})]})}function $n(){const e=R(wt),t=R(Ct),[r]=Mt(t,5e3,{maxWait:5e3}),s=t==null?void 0:t.health,i=t==null?void 0:t.storage;if(e==="Firedancer"&&!(!s||!i||!r))return n.jsxs(w,{gap:"30px",direction:"column",align:"stretch",justify:"center",height:"100%",children:[n.jsxs(w,{gapX:"50px",gapY:ue,wrap:"wrap",children:[n.jsx(Xe,{networkTraffic:r.ingress,label:"Ingress"}),n.jsx(Xe,{networkTraffic:r.egress,label:"Egress"})]}),n.jsxs(w,{gap:"30px",wrap:"wrap",children:[n.jsxs(w,{direction:"column",flexGrow:"1",flexBasis:"0",gap:ue,minWidth:Q,children:[n.jsx(Pt,{storage:i}),n.jsx(Nt,{storage:i})]}),n.jsxs(w,{direction:"column",flexGrow:"1",flexBasis:"0",gap:ue,minWidth:Q,children:[n.jsx(en,{}),n.jsx(Dt,{messages:t.messages})]})]}),n.jsx(nn,{health:s}),n.jsx(Qt,{})]})}export{$n as default};
