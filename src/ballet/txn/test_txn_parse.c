#include "fd_txn.h"

/* This transaction is from the flood pcap. It never landed on chain. */
uchar transaction1[] = {
0x04,0x61,0x66,0xae,0x2a,0x63,0xf3,0x99,0x2f,0xfc,0x38,0x1d,0x67,0x4a,0x3b,0xd4,
0x14,0x5e,0x75,0x4f,0x95,0x23,0x36,0x33,0x48,0x49,0xe4,0x2f,0x29,0x61,0x2f,0x2f,
0x14,0xb0,0x1b,0x33,0x03,0x7e,0xf7,0x7f,0xf5,0x54,0x98,0x30,0x38,0xde,0x17,0xea,
0x72,0x74,0x0e,0x20,0x37,0x9a,0x0c,0x62,0xee,0x62,0xb2,0xb5,0x97,0xf0,0x1b,0x14,
0x04,0xbd,0x52,0xe1,0x90,0xff,0x73,0xa4,0xda,0x28,0x9c,0x6c,0xf6,0xa9,0x70,0x1e,
0x07,0x17,0x2f,0x12,0x12,0xf5,0x9c,0x97,0x23,0x38,0x80,0xa4,0xba,0xd9,0xa2,0x82,
0x96,0x8c,0x53,0x1b,0x87,0xdc,0xa7,0x64,0xe4,0xe7,0x37,0x60,0x2d,0xb7,0x8e,0x6f,
0xdb,0x71,0x49,0xb1,0x25,0x48,0x5b,0x1f,0x91,0x3b,0x7e,0x48,0xc3,0xc2,0xd1,0xb5,
0x07,0x0b,0x1f,0x9e,0xdf,0x09,0xa4,0xb9,0x36,0xa9,0x6f,0xb1,0x2d,0xc1,0x90,0xab,
0xff,0xef,0xb5,0x8e,0x5f,0x2f,0xda,0x23,0x29,0x51,0xf7,0xd6,0x51,0xd4,0xcb,0x63,
0x92,0x22,0x49,0x43,0x4c,0x83,0xbf,0xe1,0x71,0x4d,0xe9,0x49,0xfc,0xc9,0xcd,0x94,
0xf4,0xbe,0x11,0x9f,0xc6,0x55,0x2d,0xa6,0x56,0x9c,0xaa,0x8b,0x0d,0x99,0xab,0x4b,
0x08,0x6c,0xdb,0x3e,0xee,0x2b,0x60,0x89,0x16,0x3c,0xe0,0x32,0xc7,0x28,0x3c,0x13,
0x6c,0x7d,0xec,0x01,0x2a,0xa7,0x94,0x3e,0x78,0xc8,0xb5,0x13,0xaf,0x2a,0xf1,0x3a,
0x2f,0xfa,0x45,0xa8,0x06,0x26,0xbf,0xe0,0xfd,0x5f,0xf8,0xda,0xc1,0xa9,0x68,0x75,
0x6d,0xd9,0xab,0x8f,0x55,0xf5,0x68,0x28,0xdc,0x0d,0x07,0xa0,0xf2,0xfb,0x69,0x9d,
0x0e,0x04,0x01,0x0b,0x17,0xdc,0x47,0x19,0xc2,0x1e,0x54,0x0b,0x68,0x18,0x4f,0x2a,
0x70,0xbb,0x2d,0x35,0x45,0x03,0xa3,0x28,0x24,0xa8,0x4a,0xf1,0xdc,0xfd,0x03,0xae,
0x83,0xd4,0xff,0x5e,0x85,0xff,0x50,0xcc,0xea,0x11,0x9e,0xf4,0xfe,0x3e,0x74,0x22,
0x05,0x0e,0x14,0x9d,0xc5,0x06,0x40,0xfe,0x17,0xad,0xe6,0x37,0xcd,0x8f,0x88,0x14,
0x50,0x00,0xa5,0xf5,0xaf,0x55,0xd0,0x58,0x9e,0x55,0x17,0x4f,0xb6,0x51,0x81,0xb2,
0xbd,0xbc,0x2e,0x48,0xc1,0xdb,0x20,0xbc,0xcf,0x90,0x25,0x4b,0x4a,0xf6,0x2b,0xca,
0x22,0xcf,0xcf,0x44,0x59,0x59,0x41,0x51,0x62,0xe4,0x9b,0x42,0x60,0xd6,0x22,0x5c,
0x87,0xa7,0x20,0x31,0x6c,0x13,0xe0,0x60,0xf9,0xae,0x97,0xb5,0x07,0x19,0xd7,0xe1,
0x52,0x63,0xf4,0xca,0xca,0xc9,0x82,0xb9,0x32,0x79,0xc2,0x15,0x0b,0x45,0x40,0x9f,
0x80,0x66,0x95,0x8a,0xa2,0xf8,0xf7,0xa2,0x9c,0x0c,0x4a,0x4b,0x11,0x1d,0x90,0x49,
0x3d,0x51,0x89,0xbf,0xec,0xaa,0xba,0xaa,0x31,0xc5,0x45,0xd7,0xbd,0x1c,0xd6,0xe7,
0x65,0x42,0xbc,0x37,0x89,0xf4,0x96,0x02,0x78,0xca,0x47,0x11,0x2e,0x3e,0x56,0xb4,
0x7b,0xa9,0xaf,0xc7,0xd6,0xc2,0x50,0xc1,0x3e,0xba,0xbb,0xb6,0xe4,0x85,0x18,0xed,
0x14,0xb5,0x18,0x00,0x99,0xa2,0x38,0x1d,0x11,0x1f,0x0c,0xd2,0x15,0x5d,0x7c,0x2d,
0xc8,0x86,0x5c,0x05,0xc2,0x30,0x4e,0x08,0x5c,0x0d,0xa4,0xc3,0xad,0xfc,0xee,0x50,
0x10,0xe8,0x94,0xd6,0xb2,0xff,0xd1,0x31,0x4e,0x55,0x9c,0xe3,0x4f,0x94,0x13,0x87,
0xa3,0x3f,0x7d,0x2a,0x7c,0xe4,0xe1,0xf8,0xf2,0x40,0x29,0x97,0x77,0x81,0x4b,0x2c,
0xa3,0x5a,0x22,0x92,0x3d,0x28,0x38,0x03,0xe8,0x3a,0x7c,0xc4,0x31,0xf5,0xe2,0xbb,
0xdf,0x1d,0x46,0x9c,0xd4,0x7b,0x1f,0x3a,0xb0,0x0c,0xfa,0x80,0x2f,0x51,0xd2,0x6a,
0xec,0xb4,0x06,0xf1,0xb7,0xe7,0x9c,0x26,0xf0,0x8c,0x80,0xca,0x1a,0xe0,0x9e,0xaf,
0x77,0x89,0xae,0xbf,0xb8,0x97,0xce,0xe2,0x25,0xa8,0xe7,0xa6,0x8f,0xa5,0xfa,0xdb,
0xcd,0x9e,0xb3,0x29,0x39,0xc1,0x27,0x29,0x37,0xa8,0x9e,0x6f,0x36,0xef,0x6e,0xbe,
0x8d,0xd7,0xab,0xfc,0x01,0x85,0x6a,0xb2,0x52,0x73,0xd0,0x93,0x5a,0x5a,0x0b,0xd9,
0xf6,0x69,0x11,0xfa,0x6a,0x14,0xb7,0x08,0xf0,0x41,0xdc,0x0f,0xfa,0x2c,0xdc,0x41,
0xea,0x67,0xd1,0x29,0x15,0x06,0x9b,0x88,0x57,0xfe,0xab,0x81,0x84,0xfb,0x68,0x7f,
0x63,0x46,0x18,0xc0,0x35,0xda,0xc4,0x39,0xdc,0x1a,0xeb,0x3b,0x55,0x98,0xa0,0xf0,
0x00,0x00,0x00,0x00,0x01,0x06,0xa7,0xd5,0x17,0x19,0x2c,0x5c,0x51,0x21,0x8c,0xc9,
0x4c,0x3d,0x4a,0xf1,0x7f,0x58,0xda,0xee,0x08,0x9b,0xa1,0xfd,0x44,0xe3,0xdb,0xd9,
0x8a,0x00,0x00,0x00,0x00,0xcb,0x07,0x99,0xc9,0x25,0xaa,0xd7,0xd6,0x52,0x7f,0x0f,
0x66,0x4f,0xcf,0x6d,0x8e,0xc3,0x72,0x52,0x9f,0x71,0x01,0xb4,0x96,0x61,0x47,0x43,
0x43,0xaf,0xf7,0xf0,0x42,0x06,0xa7,0xd5,0x17,0x19,0x2f,0x0a,0xaf,0xc6,0xf2,0x65,
0xe3,0xfb,0x77,0xcc,0x7a,0xda,0x82,0xc5,0x29,0xd0,0xbe,0x3b,0x13,0x6e,0x2d,0x00,
0x55,0x20,0x00,0x00,0x00,0x0b,0x70,0x65,0xb1,0xe3,0xd1,0x7c,0x45,0x38,0x9d,0x52,
0x7f,0x6b,0x04,0xc3,0xcd,0x58,0xb8,0x6c,0x73,0x1a,0xa0,0xfd,0xb5,0x49,0xb6,0xd1,
0xbc,0x03,0xf8,0x29,0x46,0x06,0xdd,0xf6,0xe1,0xd7,0x65,0xa1,0x93,0xd9,0xcb,0xe1,
0x46,0xce,0xeb,0x79,0xac,0x1c,0xb4,0x85,0xed,0x5f,0x5b,0x37,0x91,0x3a,0x8c,0xf5,
0x85,0x7e,0xff,0x00,0xa9,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x8c,0x97,0x25,0x8f,0x4e,0x24,0x89,0xf1,0xbb,0x3d,0x10,
0x29,0x14,0x8e,0x0d,0x83,0x0b,0x5a,0x13,0x99,0xda,0xff,0x10,0x84,0x04,0x8e,0x7b,
0xd8,0xdb,0xe9,0xf8,0x59,0x03,0x06,0x46,0x6f,0xe5,0x21,0x17,0x32,0xff,0xec,0xad,
0xba,0x72,0xc3,0x9b,0xe7,0xbc,0x8c,0xe5,0xbb,0xc5,0xf7,0x12,0x6b,0x2c,0x43,0x9b,
0x3a,0x40,0x00,0x00,0x00,0x05,0x4a,0x53,0x5a,0x99,0x29,0x21,0x06,0x4d,0x24,0xe8,
0x71,0x60,0xda,0x38,0x7c,0x7c,0x35,0xb5,0xdd,0xbc,0x92,0xbb,0x81,0xe4,0x1f,0xa8,
0x40,0x41,0x05,0x44,0x8d,0xa8,0xb4,0xf7,0x78,0x2e,0xfa,0xc6,0xc3,0x51,0xc0,0x4a,
0x47,0x83,0xdc,0x75,0x64,0xe9,0xbb,0x26,0x12,0x8a,0x7c,0x69,0x0f,0x35,0x53,0x00,
0x2c,0xbc,0x6b,0x81,0x4c,0x9b,0x19,0xcd,0x21,0xeb,0x25,0x45,0xe1,0x65,0xf7,0x62,
0xac,0x2d,0x5c,0x59,0xef,0x47,0x8a,0x28,0x30,0x62,0xd8,0x62,0x14,0xe1,0x17,0x63,
0xf2,0xce,0x70,0x7c,0xdf,0x07,0x14,0x00,0x05,0x00,0xe0,0x93,0x04,0x00,0x12,0x02,
0x00,0x01,0x0c,0x02,0x00,0x00,0x00,0x00,0x28,0x6b,0xee,0x00,0x00,0x00,0x00,0x12,
0x01,0x01,0x0c,0x08,0x00,0x00,0x00,0xa5,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x12,
0x01,0x01,0x24,0x01,0x00,0x00,0x00,0x06,0xdd,0xf6,0xe1,0xd7,0x65,0xa1,0x93,0xd9,
0xcb,0xe1,0x46,0xce,0xeb,0x79,0xac,0x1c,0xb4,0x85,0xed,0x5f,0x5b,0x37,0x91,0x3a,
0x8c,0xf5,0x85,0x7e,0xff,0x00,0xa9,0x11,0x04,0x01,0x0c,0x00,0x0d,0x01,0x01,0x15,
0x00,0x27,0x32,0x45,0x45,0x32,0x48,0x68,0x6f,0x65,0x38,0x66,0x56,0x41,0x59,0x6e,
0x37,0x4a,0x35,0x71,0x77,0x75,0x61,0x79,0x4e,0x6d,0x72,0x45,0x67,0x6d,0x54,0x50,
0x73,0x6b,0x4c,0x79,0x73,0x7a,0x6f,0x6a,0x76,0x16,0x15,0x0e,0x04,0x00,0x00,0x05,
0x01,0x06,0x03,0x07,0x02,0x08,0x09,0x0a,0x0b,0x0f,0x10,0x11,0x12,0x13,0x0d,0x03,
0x0c,0xd3,0x39,0x06,0xa7,0x0f,0xdb,0x23,0xfb,0xff,0x00,0x01,0x01
};

/* This transaction landed on mainnet. The base58 encoded signature is
   4gxceixEGkug6Da4KgTjZ9EVjEyEDWSk5QzokfucQE4d767yyxjwgv46u5y3hntprtVMGWGz1cNzWeC6DtJhUcuz */
uchar transaction2[] = {
0x01,0xb8,0x82,0x90,0x12,0x2d,0xd0,0x4f,0xc2,0x26,0x7b,0xc7,0x02,0xea,0x77,0x47,
0xfe,0xeb,0x4f,0xaa,0x65,0xd6,0x7b,0x24,0xcd,0x1b,0xfd,0x19,0x45,0xc5,0xd8,0x9c,
0x81,0xd2,0x6b,0x7e,0x72,0x98,0x77,0xc3,0xa3,0x7f,0x42,0x29,0xec,0x18,0x2e,0x04,
0x40,0x68,0x79,0x07,0x93,0x1d,0xb2,0x12,0xb2,0x81,0x36,0x8f,0x82,0xef,0x18,0x80,
0x05,0x80,0x01,0x00,0x02,0x06,0xd8,0xb0,0x2f,0x58,0xb6,0x37,0x2a,0xf1,0xdd,0xd9,
0x6d,0x83,0xe1,0x5d,0xbf,0xb4,0xf5,0x92,0xe1,0x9d,0x4a,0xe5,0x2c,0x87,0x44,0x53,
0x5c,0x93,0x80,0x13,0x83,0x54,0xb0,0xd2,0x19,0xbc,0x50,0x5f,0xf8,0x02,0x27,0x5e,
0xf9,0x0d,0xb3,0x26,0xf3,0x96,0xdb,0xed,0x14,0xe0,0x72,0x30,0xf2,0x13,0xe1,0xa4,
0x7f,0xda,0x7a,0xef,0xf2,0xae,0x09,0xf5,0xf0,0x7d,0x09,0x47,0xf9,0x7c,0x76,0xcd,
0x22,0x01,0x31,0x7d,0x71,0x4f,0xc3,0x3c,0x8a,0x07,0x33,0x68,0xb2,0x03,0xdc,0xdf,
0x9f,0xee,0xd6,0x7d,0xe6,0xa7,0xd5,0x34,0x4a,0xd1,0x67,0x49,0x86,0x9c,0x31,0xf1,
0xd2,0x19,0xce,0x40,0xd2,0xf9,0xc1,0xe9,0x11,0x06,0xf1,0x05,0x05,0x87,0xb1,0x65,
0x6f,0x7e,0x94,0x3e,0xcc,0x00,0x03,0x06,0x46,0x6f,0xe5,0x21,0x17,0x32,0xff,0xec,
0xad,0xba,0x72,0xc3,0x9b,0xe7,0xbc,0x8c,0xe5,0xbb,0xc5,0xf7,0x12,0x6b,0x2c,0x43,
0x9b,0x3a,0x40,0x00,0x00,0x00,0x04,0x79,0xd5,0x2d,0xed,0xbf,0x6b,0xc5,0xec,0xd0,
0x9d,0x84,0x53,0x4a,0x34,0xae,0xa5,0x97,0x50,0x43,0xb3,0x6f,0xd0,0x2b,0x24,0x65,
0x0b,0xb5,0x84,0x43,0x59,0x5c,0x94,0xe5,0xa4,0x33,0x0a,0x11,0xcc,0x5e,0x67,0x0d,
0xfb,0xaf,0x89,0x2f,0xc2,0x2b,0x39,0xe1,0x6a,0x94,0x61,0xd8,0x34,0x96,0xe4,0x6c,
0xcb,0x74,0xfc,0xf0,0xf5,0x32,0x02,0x04,0x00,0x05,0x02,0xc0,0x5c,0x15,0x00,0x05,
0x27,0x12,0x00,0x01,0x13,0x12,0x14,0x15,0x00,0x01,0x06,0x07,0x02,0x08,0x09,0x13,
0x12,0x16,0x17,0x00,0x02,0x0a,0x0b,0x03,0x0c,0x0d,0x18,0x00,0x19,0x0e,0x03,0x01,
0x0f,0x10,0x11,0x18,0x12,0x1a,0x11,0x05,0x26,0xe5,0x17,0xcb,0x97,0x7a,0xe3,0xad,
0x2a,0x00,0x03,0x00,0x00,0x00,0x02,0x03,0x02,0x03,0x02,0x0b,0x80,0x96,0x98,0x00,
0x00,0x00,0x00,0x00,0x44,0xbe,0x98,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,
0x36,0x21,0xda,0xa0,0xae,0x26,0xa3,0xa0,0xf5,0x91,0x9e,0x22,0x15,0x29,0x5f,0xcb,
0xac,0xb7,0xe7,0x88,0x0b,0x04,0x48,0x29,0x54,0x4f,0x1b,0xf3,0x4f,0xd2,0x3a,0x21,
0x04,0x8e,0x8d,0x8f,0x90,0x04,0x01,0x75,0x8b,0x8c,0x22,0xea,0xcd,0x97,0x05,0xcf,
0xbf,0x25,0x08,0x09,0x40,0xb8,0xbf,0x1d,0xa0,0xd5,0x99,0xfb,0x38,0x2f,0xed,0x51,
0xa0,0xdc,0xba,0x74,0x13,0x11,0xd0,0x7a,0x9c,0x9e,0x04,0xc4,0xc5,0xc6,0xc7,0x04,
0xc2,0xc3,0x75,0x76,0xd4,0x84,0x51,0xb9,0x16,0xd7,0xdd,0x92,0xca,0x96,0xd3,0xb3,
0x92,0x72,0x84,0x00,0xb7,0xe5,0xfe,0x7e,0x58,0x5a,0x47,0xff,0xa1,0xfa,0x6f,0xac,
0xcc,0xcb,0x58,0xc0,0x04,0x5b,0x5c,0x5d,0x5e,0x01,0x61
};

/* When parsed, this transaction takes up the maximum amount of space */
uchar transaction3[1232] = {
0x01,0xa4,0x83,0xf8,0xfa,0x7f,0x4d,0x6b,0xfe,0xe3,0x56,0xb8,0x71,0x3a,0xc3,0xf1,
0x0b,0x52,0x09,0x69,0xa6,0x98,0xbc,0x16,0xb3,0x98,0x1a,0x77,0xdf,0xec,0x3a,0x2b,
0xba,0x89,0x34,0xd0,0xce,0x46,0x59,0x9f,0x3a,0x9d,0x8c,0xc2,0x72,0x69,0x34,0xd2,
0x83,0xc6,0x3e,0x92,0xf0,0x37,0xea,0xaa,0x54,0xdf,0x16,0xbd,0xd8,0x55,0x31,0xbe,
0x01,0x01,0x00,0x01,0x02,0xae,0x50,0x1f,0xe2,0xf5,0xf4,0x54,0x40,0x4e,0xbf,0x5c,
0xa0,0x63,0x57,0xc9,0xe2,0xa9,0xb7,0x76,0x2e,0x07,0xe5,0x1c,0x3c,0xda,0x59,0xb8,
0x08,0x60,0x89,0x66,0x6d,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x01,0xc4,0x9a,0xe7,0x76,0x03,0x78,0x20,0x54,0xf1,0x7a,0x9d,
0xec,0xea,0x43,0xb4,0x44,0xeb,0xa0,0xed,0xb1,0x2c,0x6f,0x1d,0x31,0xc6,0xe0,0xe4,
0xa8,0x4b,0xf0,0x52,0xeb,0xe3,0x02,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,
0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,
0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,
0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,
0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,
0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,
0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,
0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,
0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,
0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,
0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,
0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,
0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,
0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,
0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,
0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,
0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,
0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,
0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,
0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,
0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,
0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,
0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,
0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,
0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,
0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,
0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,
0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,
0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,
0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,
0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,
0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,
0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,
0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,
0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,
0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,
0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,
0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,
0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,
0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,
0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,
0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,
0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,
0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,
0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,
0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,
0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,
0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,
0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,
0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,
0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,
0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,
0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,
0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,
0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,
0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,
0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,
0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,
0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,
0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,
0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,
0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,
0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,
0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,
0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,
0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,
0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00,0x01,0x00,0x00};

uchar out_buf[ FD_TXN_MAX_SZ ];
uchar test_buf[ FD_TXN_MAX_SZ ];

uchar min_okay[ 1232 ];
uchar max_okay[ 1232 ];

void txn1_correctness( void ) {
  fd_txn_parse_counters_t  counters = {0};
  const uchar first_sig_byte[4] = { 97, 189, 11, 108 };
  const uchar first_acct_byte[23] = {220, 255, 85, 89, 201, 170, 194, 48, 228, 123, 151, 133, 6, 6, 203, 6, 11, 6, 0, 140, 3, 5, 168};
  fd_txn_t * parsed = (fd_txn_t *)out_buf;
  ulong out_sz = fd_txn_parse( transaction1, sizeof(transaction1), out_buf, &counters );
  FD_TEST( out_sz );
  FD_TEST( counters.success_cnt==1UL );
  FD_TEST( counters.failure_cnt==0UL );
  FD_TEST( parsed->transaction_version == FD_TXN_VLEGACY );
  FD_TEST( parsed->signature_cnt == 4UL );
  fd_ed25519_sig_t const * sigs = fd_txn_get_signatures( parsed, transaction1 );
  for( ulong j=0UL; j<parsed->signature_cnt; j++ ) {
    FD_TEST( transaction1[ parsed->signature_off + j*FD_TXN_SIGNATURE_SZ ]==first_sig_byte[ j ] );
    FD_TEST( sigs[ j ][ 0 ]                                               ==first_sig_byte[ j ] );
  }
  FD_TEST( parsed->message_off == parsed->signature_off + parsed->signature_cnt*FD_TXN_SIGNATURE_SZ );
  FD_TEST( parsed->readonly_signed_cnt   ==  1UL );
  FD_TEST( parsed->readonly_unsigned_cnt == 11UL );
  FD_TEST( parsed->acct_addr_cnt         == 23UL );
  for( ulong j=0UL; j<parsed->acct_addr_cnt; j++ )
    FD_TEST( transaction1[ parsed->acct_addr_off + j*FD_TXN_ACCT_ADDR_SZ ]==first_acct_byte[ j ] );
  FD_TEST( transaction1[ parsed->recent_blockhash_off ] == 155UL );
  FD_TEST( parsed->addr_table_lookup_cnt        == 0UL );
  FD_TEST( parsed->addr_table_adtl_writable_cnt == 0UL );
  FD_TEST( parsed->addr_table_adtl_cnt          == 0UL );
  FD_TEST( parsed->instr_cnt == 7UL );
  fd_txn_instr_t * ix = parsed->instr;
  FD_TEST( ix[ 0 ].program_id == 20UL );
  FD_TEST( ix[ 0 ].acct_cnt   ==  0UL );
  FD_TEST( ix[ 0 ].data_sz    ==  5UL );
  FD_TEST( !memcmp( &transaction1[ ix[ 0 ].data_off ], "\x00\xE0\x93\x04\x00", 5 ) );

  FD_TEST( ix[ 1 ].program_id == 18UL );
  FD_TEST( ix[ 1 ].acct_cnt   ==  2UL );
  FD_TEST( ix[ 1 ].data_sz    == 12UL );
  FD_TEST( transaction1[ ix[ 1 ].acct_off ] == 0UL );
  FD_TEST( transaction1[ ix[ 1 ].data_off ] == 2UL );

  FD_TEST( ix[ 6 ].program_id == 22UL );
  FD_TEST( ix[ 6 ].acct_cnt   == 21UL );
  FD_TEST( ix[ 6 ].data_sz    == 12UL );
  FD_TEST( transaction1[ ix[ 6 ].acct_off ] ==  14UL );
  FD_TEST( transaction1[ ix[ 6 ].data_off ] == 211UL );
}
void txn2_correctness( void ) {
  fd_txn_parse_counters_t counters = {0};
  const uchar first_sig_byte[1] = { 184 };
  const uchar first_acct_byte[6] = { 216, 176, 9, 213, 3, 4 };
  const uchar first_lut_writable[4] = {142, 141, 143, 144};
  fd_txn_t * parsed = (fd_txn_t *)out_buf;
  ulong out_sz = fd_txn_parse( transaction2, sizeof(transaction2), out_buf, &counters );
  FD_TEST( out_sz );
  FD_TEST( counters.success_cnt==1UL );
  FD_TEST( counters.failure_cnt==0UL );
  FD_TEST( parsed->transaction_version == FD_TXN_V0 );
  FD_TEST( parsed->signature_cnt == 1UL );
  fd_ed25519_sig_t const * sigs = fd_txn_get_signatures( parsed, transaction2 );
  for( ulong j=0UL; j<parsed->signature_cnt; j++ ) {
    FD_TEST( transaction2[ parsed->signature_off + j*FD_TXN_SIGNATURE_SZ ]==first_sig_byte[ j ] );
    FD_TEST( sigs[ j ][ 0 ]                                               ==first_sig_byte[ j ] );
  }
  FD_TEST( parsed->message_off == parsed->signature_off + parsed->signature_cnt*FD_TXN_SIGNATURE_SZ );
  FD_TEST( parsed->readonly_signed_cnt   == 0UL );
  FD_TEST( parsed->readonly_unsigned_cnt == 2UL );
  FD_TEST( parsed->acct_addr_cnt         == 6UL );
  for( ulong j=0UL; j<parsed->acct_addr_cnt; j++ )
    FD_TEST( transaction2[ parsed->acct_addr_off + j*FD_TXN_ACCT_ADDR_SZ ]==first_acct_byte[ j ] );
  FD_TEST( transaction2[ parsed->recent_blockhash_off ] == 148UL );
  FD_TEST( parsed->addr_table_lookup_cnt        == 3UL );
  FD_TEST( parsed->addr_table_adtl_writable_cnt == 12UL );
  FD_TEST( parsed->addr_table_adtl_cnt          == 21UL );
  FD_TEST( parsed->instr_cnt == 2UL );
  fd_txn_instr_t * ix = parsed->instr;
  FD_TEST( ix[ 0 ].program_id == 4UL );
  FD_TEST( ix[ 0 ].acct_cnt   == 0UL );
  FD_TEST( ix[ 0 ].data_sz    == 5UL );

  FD_TEST( ix[ 1 ].program_id ==  5UL );
  FD_TEST( ix[ 1 ].acct_cnt   == 39UL );
  FD_TEST( ix[ 1 ].data_sz    == 38UL );
  FD_TEST( transaction2[ ix[ 1 ].acct_off ] ==  18UL );
  FD_TEST( transaction2[ ix[ 1 ].data_off ] == 229UL );

  fd_txn_acct_addr_lut_t * luts = fd_txn_get_address_tables( parsed );
  FD_TEST( transaction2[ luts[ 0 ].addr_off ] == 54UL );
  FD_TEST( luts[ 0 ].writable_cnt == 4UL );
  FD_TEST( luts[ 0 ].readonly_cnt == 4UL );
  FD_TEST( !memcmp( &transaction2[ luts[ 0 ].writable_off ], first_lut_writable, 4 ) );
  FD_TEST( transaction2[ luts[ 0 ].readonly_off + 1 ] == 117UL );

  FD_TEST( transaction2[ luts[ 1 ].addr_off ] == 34UL );
  FD_TEST( luts[ 1 ].writable_cnt == 4UL );
  FD_TEST( luts[ 1 ].readonly_cnt == 4UL );
  FD_TEST( transaction2[ luts[ 1 ].writable_off ] == 196UL );
  FD_TEST( transaction2[ luts[ 1 ].readonly_off ] == 194UL );

  FD_TEST( transaction2[ luts[ 2 ].addr_off ] == 212UL );
  FD_TEST( luts[ 2 ].writable_cnt == 4UL );
  FD_TEST( luts[ 2 ].readonly_cnt == 1UL );
  FD_TEST( transaction2[ luts[ 2 ].writable_off ] == 91UL );
  FD_TEST( transaction2[ luts[ 2 ].readonly_off ] == 97UL );

}

void test_mutate( uchar * payload,
    ulong len ) {
  fd_txn_parse_counters_t counters = {0};
  fd_txn_t * parsed = (fd_txn_t *)out_buf;
  ulong out_sz = fd_txn_parse( payload, len, out_buf, NULL );
  FD_TEST( out_sz );
  ulong footprint = fd_txn_footprint( parsed->instr_cnt, parsed->addr_table_lookup_cnt );
  FD_TEST( out_sz==footprint );
  fd_txn_acct_addr_lut_t * tables = fd_txn_get_address_tables( parsed );

  /* The transaction should be valid if for each byte payload[ i ],
      min_okay[ i ] <= payload[ i ] <= max_okay[ i ]
   */
  fd_memcpy( min_okay, payload, len );
  fd_memcpy( max_okay, payload, len );

#define MUT_OKAY( start, len ) do { for( ulong _=(start); _<(start)+(len); _++ ) { min_okay[ _ ] = 0; max_okay[ _ ] = 0xFFUL; } } while( 0 )
  MUT_OKAY( parsed->signature_off,        parsed->signature_cnt*FD_TXN_SIGNATURE_SZ );
  MUT_OKAY( parsed->acct_addr_off,        parsed->acct_addr_cnt*FD_TXN_ACCT_ADDR_SZ );
  MUT_OKAY( parsed->recent_blockhash_off,                       FD_TXN_BLOCKHASH_SZ );
  ulong signed_ro_idx = parsed->message_off + (parsed->transaction_version==FD_TXN_V0 ? 2UL : 1UL );
  min_okay[ signed_ro_idx   ] = 0;
  max_okay[ signed_ro_idx   ] = (uchar)(parsed->signature_cnt-1);
  min_okay[ signed_ro_idx+1 ] = 0;
  max_okay[ signed_ro_idx+1 ] = (uchar)(parsed->acct_addr_cnt - parsed->signature_cnt);
  for( ulong j=0; j<parsed->instr_cnt; j++ ) {
    min_okay[ parsed->instr[ j ].acct_off-2 ] = 1;
    max_okay[ parsed->instr[ j ].acct_off-2 ] = (uchar)(parsed->acct_addr_cnt + parsed->addr_table_adtl_cnt - 1);
    MUT_OKAY( parsed->instr[ j ].data_off, parsed->instr[ j ].data_sz  );
    for( ulong k=0; k<parsed->instr[ j ].data_sz; k++ ) {
      /* Modify contents of instruction data to make it unlikely that reading
         these bytes as some other field can give a valid transaction. */
      payload[ parsed->instr[ j ].data_off+k ] = (uchar)0xDA;
    }
    ulong total_accts = (ulong)parsed->acct_addr_cnt + (ulong)parsed->addr_table_adtl_cnt;
    for( ulong k=0; k<parsed->instr[ j ].acct_cnt; k++ ) {
      min_okay[ parsed->instr[ j ].acct_off+k ] = 0;
      max_okay[ parsed->instr[ j ].acct_off+k ] = (uchar)(parsed->acct_addr_cnt + parsed->addr_table_adtl_cnt - 1);
      /* Modify contents of which accounts the instruction references to make
         it unlikely that reading these bytes as some other field can give a
         valid transaction. */
      payload[ parsed->instr[ j ].acct_off+k ] = (uchar)((total_accts-1UL-k)%total_accts);
    }
  }
  for( ulong j=0; j<parsed->addr_table_lookup_cnt; j++ ) {
    MUT_OKAY( tables[ j ].addr_off,     FD_TXN_ACCT_ADDR_SZ );
    MUT_OKAY( tables[ j ].writable_off, tables[ j ].writable_cnt );
    MUT_OKAY( tables[ j ].readonly_off, tables[ j ].readonly_cnt );
  }
  FD_TEST( fd_txn_parse( payload, len, test_buf, NULL ) );
  FD_TEST( !memcmp( out_buf, test_buf, footprint ) );

#undef MUT_OKAY
  for( ulong i=0; i<len; i++ ) {
    /* Test truncated version */
    FD_TEST( !fd_txn_parse( payload, i, test_buf, &counters ) );
    uchar orig = payload[ i ];
    for( ulong off=1; off<256; off++ ) {
      payload[ i ] = (uchar)(orig+off);
      ulong mut_parsed_footprint = fd_txn_parse( payload, len, test_buf, &counters );
      fd_txn_t * mut_parsed = (fd_txn_t *)test_buf;
      if( min_okay[ i ]==0 && max_okay[ i ]==255 ) {
        FD_TEST( footprint == mut_parsed_footprint );
        FD_TEST( !memcmp( parsed, mut_parsed, footprint ) );
      } else if ( payload[ i ]<min_okay[ i ] || payload[ i ]>max_okay[ i ] ) {
        FD_TEST( !mut_parsed_footprint );
      } else {
        FD_TEST( mut_parsed_footprint );
      }
    }
    payload[ i ] = orig;
  }
  FD_TEST( counters.success_cnt );
  FD_TEST( counters.failure_cnt );
  FD_TEST( (counters.success_cnt+counters.failure_cnt) == 256*len );
  for( ulong i=0UL; i<FD_TXN_PARSE_COUNTERS_RING_SZ; i++ ) FD_TEST( counters.failure_ring[ i ] );
}


void test_performance( uchar const * payload,
                       ulong sz ) {
  const ulong test_count = 1000000;
  long start = fd_log_wallclock( );
  for( ulong i = 0; i < test_count; i++ ) {
    FD_TEST( fd_txn_parse( payload, sz, out_buf, NULL ) );
  }
  long end = fd_log_wallclock( );
  FD_LOG_NOTICE(( "Average time per parse: %f ns", (double)(end-start)/(double)test_count ));
}

int
main( int     argc,
      char ** argv ) {
  fd_boot( &argc, &argv );

  fd_rng_t _rng[1]; fd_rng_t * rng = fd_rng_join( fd_rng_new( _rng, 0U, 0UL ) );

  txn1_correctness( );
  txn2_correctness( );

  test_performance( transaction1, sizeof(transaction1) );
  test_performance( transaction2, sizeof(transaction2) );

  test_mutate( transaction1, sizeof(transaction1) );
  test_mutate( transaction2, sizeof(transaction2) );

  FD_TEST( FD_TXN_MAX_SZ == fd_txn_parse( transaction3, sizeof(transaction3), out_buf, NULL ) );
  fd_rng_delete( fd_rng_leave( rng ) );

  FD_LOG_NOTICE(( "pass" ));
  fd_halt();
  return 0;
}

