#include "../fd_quic.h"

#include <stdio.h>
#include <stdlib.h>

extern uchar  pkt_full[];
extern ulong pkt_full_sz;

ulong
aio_cb( void * context, fd_aio_buffer_t * batch, ulong batch_sz ) {
  (void)context;

  printf( "aio_cb callback\n" );
  for( ulong j = 0; j < batch_sz; ++j ) {
    printf( "batch %d\n", (int)j );
    uchar const * data = (uchar const *)batch[j].data;
    for( ulong k = 0; k < batch[j].data_sz; ++k ) {
      printf( "%2.2x ", (unsigned)data[k] );
    }
    printf( "\n\n" );
  }

  fflush( stdout );

  return batch_sz; /* consumed all */
}

int
main( int argc, char ** argv ) {
  (void)argc;
  (void)argv;
  // Transport params:
  //   original_destination_connection_id (0x00)         :   len(0)
  //   max_idle_timeout (0x01)                           : * 60000
  //   stateless_reset_token (0x02)                      :   len(0)
  //   max_udp_payload_size (0x03)                       :   0
  //   initial_max_data (0x04)                           : * 1048576
  //   initial_max_stream_data_bidi_local (0x05)         : * 1048576
  //   initial_max_stream_data_bidi_remote (0x06)        : * 1048576
  //   initial_max_stream_data_uni (0x07)                : * 1048576
  //   initial_max_streams_bidi (0x08)                   : * 128
  //   initial_max_streams_uni (0x09)                    : * 128
  //   ack_delay_exponent (0x0a)                         : * 3
  //   max_ack_delay (0x0b)                              : * 25
  //   disable_active_migration (0x0c)                   :   0
  //   preferred_address (0x0d)                          :   len(0)
  //   active_connection_id_limit (0x0e)                 : * 8
  //   initial_source_connection_id (0x0f)               : * len(8) ec 73 1b 41 a0 d5 c6 fe
  //   retry_source_connection_id (0x10)                 :   len(0)

  /* all zeros transport params is a reasonable default */
  fd_quic_transport_params_t tp[1] = {0};

  /* establish these parameters as "present" */
  tp->max_idle_timeout                               = 60000;
  tp->max_idle_timeout_present                       = 1;
  tp->initial_max_data                               = 1048576;
  tp->initial_max_data_present                       = 1;
  tp->initial_max_stream_data_bidi_local             = 1048576;
  tp->initial_max_stream_data_bidi_local_present     = 1;
  tp->initial_max_stream_data_bidi_remote            = 1048576;
  tp->initial_max_stream_data_bidi_remote_present    = 1;
  tp->initial_max_stream_data_uni                    = 1048576;
  tp->initial_max_stream_data_uni_present            = 1;
  tp->initial_max_streams_bidi                       = 128;
  tp->initial_max_streams_bidi_present               = 1;
  tp->initial_max_streams_uni                        = 128;
  tp->initial_max_streams_uni_present                = 1;
  tp->ack_delay_exponent                             = 3;
  tp->ack_delay_exponent_present                     = 1;
  tp->max_ack_delay                                  = 25;
  tp->max_ack_delay_present                          = 1;
  tp->active_connection_id_limit                     = 8;
  tp->active_connection_id_limit_present             = 1;

  fd_quic_config_t quic_config = {0};

  quic_config.transport_params      = tp;
  quic_config.max_concur_conns      = 10;
  quic_config.max_concur_conn_ids   = 10;
  quic_config.max_concur_streams    = 10;
  quic_config.max_concur_handshakes = 10;
  quic_config.conn_id_sparsity      = 4;

  quic_config.cert_file             = "cert.pem";
  quic_config.key_file              = "key.pem";

  quic_config.host_cfg.hostname = "localhost";
  quic_config.host_cfg.ip_addr  = 0x7f000001u;
  quic_config.host_cfg.udp_port = 4433;

  ulong align = fd_quic_align();
  ulong fp    = fd_quic_footprint( &quic_config );
  void * mem = malloc( fp + align );
  ulong smem = (ulong)mem;
  ulong memalign = smem % align;
  void *aligned = ((uchar*)mem) + ( memalign == 0 ? 0 : ( align - memalign ) );
  fd_quic_t * quic = fd_quic_new( aligned, &quic_config );
  if( FD_UNLIKELY( !quic ) ) FD_LOG_ERR(( "fd_quic_new returned NULL" ));

  fd_aio_t * aio_n2q = fd_quic_get_aio_net_in( quic );
  fd_aio_t   aio_q2n[1] = {{aio_cb,0}};
  fd_quic_set_aio_net_out( quic, aio_q2n );

  /* set up quic as server */
  fd_quic_listen( quic );

  /* set up packet to write */

  fd_aio_buffer_t buf[1] = {{ pkt_full, pkt_full_sz }};

  /* write into net-to-quic */
  fd_aio_send( aio_n2q, buf, 1 );

  /* do general processing */
  fd_quic_service( quic );

  fd_quic_delete( quic );

  free( mem );

  return 0;
}


// a packet containing many headers
uchar pkt_full[] =
#if 0
    "\x12\x34\x56\x78\x9a\xbc\xde\xf0\x01\x12\x34\x56\x08\x00\x45\x00"
    "\x05\x1c\xe9\xa8\x40\x00\x40\x11\x4e\x26\x7f\x00\x00\x01\x7f\x00"
    "\x00\x01\x87\xc1\x11\x51\x05\x08\x03\x1c\xce\x00\x00\x00\x01\x08"
    "\x7c\xa5\x71\xc2\x03\xab\x72\x51\x08\x07\x8b\xdb\x1e\x5d\x57\x87"
    "\xa9\x00\x44\xe6\x49\x65\xe9\x36\x26\xa0\x9b\x5b\xd0\x67\x7a\x9d"
    "\xec\xf9\xa2\xdc\x9e\x1e\x89\x85\x74\xc6\x5b\xfc\xaa\xf5\x03\xda"
    "\xe7\xd8\x18\xb1\xba\x2f\x85\xd5\x0d\xcb\x59\x82\x75\xde\xe5\xd8"
    "\xb2\x15\x64\x15\xa6\x4e\x76\xd4\x28\xe1\xa8\x65\x4c\xde\x98\x3c"
    "\xab\xfc\x88\xfe\x0c\xad\xb0\xdf\x4f\x4a\x25\xfb\x24\xa6\xf8\x8a"
    "\x7d\xd8\x7e\x90\xe0\x6b\x66\xc0\x6d\xcb\xae\x6d\xd0\x76\x4f\xcf"
    "\xab\xa4\x40\xaf\x60\x0e\x8a\x14\x56\xf5\x96\xcf\xa5\x57\x61\x81"
    "\x7a\x34\x68\xef\x44\x1d\xc7\x1b\x9b\x5f\x44\x0a\xff\x19\x6b\xe5"
    "\x3d\x3a\xb4\x9a\xcc\xc5\xc8\x31\x4b\x0d\xff\x64\x48\x54\xaa\x9d"
    "\xd4\x60\x4f\x54\xa6\x5c\x55\xae\x35\xcb\xbe\x3a\x52\x18\x95\x47"
    "\xeb\xaf\x43\xf8\xc6\x89\xb6\x69\x67\xd6\xe3\xb0\x32\xce\x2d\xb8"
    "\x25\x08\xd5\xcf\x7a\xa8\x94\x8f\xf6\x1a\xf7\xba\x8b\xc3\xf5\x8a"
    "\x69\x18\xcd\x92\x81\x3e\x9a\x5a\xdf\xc8\x9c\x10\x0a\xd9\xa8\xb9"
    "\x58\x85\xd1\xfe\x08\x1a\xc2\x30\x02\x7b\xd0\x57\x7b\xa7\x1f\x58"
    "\xa6\xe2\xf4\x5a\xbc\x90\x5e\x86\x39\x3c\xcf\x8a\xf5\x5f\x3d\xae"
    "\xb3\x6a\xba\xd7\xae\xba\xf5\xdb\x0a\x84\x71\x75\xf8\x88\xc0\x7f"
    "\x3e\x4b\x21\xa6\x27\x38\x6b\x07\x58\xc7\x20\xac\x4c\x19\xa9\x5b"
    "\x63\x18\x2e\xf7\x03\x58\x0e\xf2\xab\x97\x7a\xce\x22\x75\xda\x19"
    "\x14\x47\xda\xf9\xf5\x1a\x9a\xa5\x5b\x83\x78\x63\xfe\x71\x10\x67"
    "\x70\xc0\x49\x05\xd9\x2e\x6f\xf9\x99\xe1\xae\xfd\xb1\x3e\x17\x6f"
    "\x92\x5a\x5e\xc4\xf3\xaf\x51\xeb\x03\xe9\xc3\xca\x8e\x91\xb3\xd9"
    "\xb4\x66\x0a\xfd\x98\x2d\xd7\xbd\x6f\x35\xbc\x3e\xf5\xda\xb6\x8b"
    "\x84\xa0\x8a\x72\x8e\xb6\x9e\xcc\xb0\x82\x23\x07\xff\x15\x5c\x44"
    "\x36\x58\x3c\x15\x3c\xad\x16\xf3\xec\xe3\x96\x7e\x74\x4a\x1e\xdd"
    "\x43\x87\xc1\x19\xa9\xf3\x67\x4a\x9f\xd9\x68\x04\x37\x74\xf3\x29"
    "\x29\x4c\xc8\x95\xea\x95\xbd\x30\xb6\x36\xd8\x94\xc4\xe3\xee\xfc"
    "\xdc\xfd\x90\xa2\x1d\xb9\x85\xb5\x8f\x8c\xef\x1a\xfc\x9c\xf2\x54"
    "\x06\xe4\x6b\xbf\x45\x5a\x5e\xca\xda\x96\xff\xef\x06\xfd\x97\xf3"
    "\x6c\x4e\x31\x08\x18\x21\xfc\x02\x46\x2f\x7b\xd1\x86\x1a\x39\xd3"
    "\xe6\x09\x6f\xec\x45\xd9\xa0\xc6\x6e\x2a\xd1\x3e\xfa\x32\x44\x04"
    "\xf9\xb9\x70\xd2\xb3\xf5\x9d\xff\xfc\x48\x0f\xe5\x0d\x2b\x75\xc0"
    "\xff\xc8\x98\xd7\x4b\x09\xd8\x7b\x4f\x8f\xf2\xe6\x15\xdb\x08\x4e"
    "\x0d\x6d\xb6\x2a\xd3\x99\x9b\xea\xf3\x00\x47\x7a\x7a\xc7\x72\x7c"
    "\x88\x04\x96\x50\xdb\x80\xa3\xeb\x83\xf2\xf7\x39\x56\xae\x71\xd2"
    "\xab\x94\x5d\xae\xa5\x69\x92\x17\x8e\x13\x99\xcf\x4b\x07\x28\xae"
    "\xc3\x48\xec\xc4\x86\x02\xb9\xc8\x47\x96\xa1\x58\x14\x5d\x8f\x9e"
    "\xb4\x7e\x48\xee\x8d\xb3\xe5\x7c\x08\x6e\xdd\x51\xe0\xcb\x60\xef"
    "\x18\x78\x70\x2a\x39\x5f\xd3\x49\xf8\xe2\x37\x20\xb5\x24\xf5\x4c"
    "\x83\x44\xfe\x6b\xc9\xbf\x97\x7e\xff\x81\x5e\x2b\x60\x0e\x30\xbb"
    "\xa3\xb3\x66\x2a\x07\x57\xad\x94\xd2\x20\xec\x96\xd7\x46\xc7\x8a"
    "\x65\x6b\x49\xdf\x0d\x6d\xeb\x42\xf2\x63\x2a\x74\x38\xe8\x23\xc6"
    "\x87\x14\x52\xc1\x2d\x33\xf4\x68\x8f\xe1\xa3\xb4\x69\x3a\x00\xbc"
    "\x40\x74\x18\xc2\xb9\x79\x55\x2c\xb5\x11\x26\xcc\x5d\x57\xfd\x0a"
    "\xa8\x3d\x09\x54\x70\xa0\x03\x37\x79\x2d\x99\xb9\x31\x9f\x3c\xfc"
    "\x5f\x05\x22\x08\x1c\x01\xf9\x30\x0f\x88\xf3\xc9\x76\x0b\xc3\x16"
    "\x77\xb6\x21\xe0\xd2\x1b\x96\xb4\x18\xd4\x40\x0e\x72\xa5\x57\x2a"
    "\x11\x92\x80\x70\x9f\xe5\x9c\xb0\xa9\xae\x88\x35\xd9\x56\x3c\x77"
    "\xe5\x7c\xee\xfd\x18\x47\xb5\xcf\xfa\xa0\x5f\x4a\x3b\x4a\x5f\xfd"
    "\xbb\x2c\x7a\x83\x2b\xf6\xb9\xe8\x7d\xe0\x01\xdb\x87\xe5\x0e\x89"
    "\x7e\xcc\xb4\x87\xae\x40\x80\x34\x30\xc2\x21\x36\x0b\x5f\xfa\x3b"
    "\x4f\xac\x50\x54\x5c\xf2\x98\x21\x12\x4f\xed\xcc\xd9\xf7\x7a\xf1"
    "\xc2\xa0\xeb\xab\xdc\x6a\x0c\xcc\xf3\x88\x96\xb4\xd1\x16\x80\xaf"
    "\x55\x44\xd4\xcf\xc8\x9b\xc8\xfd\x50\xe6\x88\xf4\x8f\x95\x82\x91"
    "\xa1\xb6\x2f\x30\xc1\x8a\xc2\x90\xdd\x18\x70\x45\x54\x35\x7e\xef"
    "\xa7\x8c\x42\x66\x01\x63\x88\x98\xa8\x18\xa6\x63\xa5\x27\x87\x4a"
    "\x3f\xb1\x2b\x6b\xa5\x82\x1a\xe2\xc4\xde\xf8\xae\xf3\xd8\x8e\xec"
    "\x79\x9c\xf4\xc7\x7e\x19\x37\x1f\xae\x40\xfa\x60\xf2\xff\xdc\x7e"
    "\xba\x2f\x49\xba\xe6\xda\xdc\x44\x2f\x69\x0c\xb0\x40\xb9\x4a\x54"
    "\x95\x83\x1c\x04\xa8\x79\xff\x40\xa6\x83\x30\x38\x00\x29\x27\x41"
    "\xfd\x6c\x2a\xcd\x4c\x0e\x1a\x00\x5f\x8e\xc2\x63\x6c\x0f\x18\xd5"
    "\x55\xea\x24\xb6\xbb\xb5\x0d\x10\x09\xcd\x15\xfa\x27\x86\x23\x7b"
    "\x78\x7d\x6c\x8e\x63\xe4\x3f\x6e\x56\x87\xb7\x2c\xd9\xdf\x16\x7e"
    "\xa4\x34\xa2\xa5\x89\x71\x8c\xd3\x88\x76\x81\x6d\x10\x23\xf4\xe0"
    "\xc0\x2c\xd5\x34\x3c\xab\xc6\x0e\x94\x16\x04\x18\x62\x06\x4d\xd9"
    "\x6d\x59\x4c\xba\x3b\x49\x99\x97\x36\xf5\xb9\xa6\xe2\x93\x97\xd0"
    "\xad\x7c\x80\x39\x40\x7e\x21\xcd\x76\xbf\x89\xb8\x71\x14\xf2\xe7"
    "\xbd\xbd\x1d\x74\xef\x0a\x08\x78\x0d\x07\xda\x2f\x9c\x08\xd7\xf1"
    "\xea\x31\x1a\xe1\xbc\x9e\x23\xd0\xd0\x3e\xc2\x43\x36\x2c\xed\x7a"
    "\xfb\x94\xd6\x97\xf4\xee\xf1\xbf\x44\xd7\xd4\x11\x68\xe7\xd0\x57"
    "\x56\xad\xf9\xfa\x29\xf1\x47\xbe\x32\xc8\x4c\x42\x29\xe5\xef\x52"
    "\x1b\x41\xf3\x7e\x69\x01\xdc\x88\x29\xff\x83\x2c\x86\x24\x72\x54"
    "\xe2\x70\x11\xa4\xff\xde\xcf\x94\xc6\x84\xb4\x90\x6f\x6d\xe9\x19"
    "\x00\xb4\x55\x76\x6a\x78\xa1\x9b\xc5\x23\x46\x6c\xd6\x8d\x17\x77"
    "\xf3\x33\xc3\xe6\xe5\x3d\x75\x03\x96\x4a\x80\x13\xc5\xf7\x06\x63"
    "\xb7\xcc\x4c\x56\xde\x91\x5f\xd6\x41\xad\xd3\x31\x5f\x69\x15\x9d"
    "\x9b\xa5\x9b\xb6\x74\x78\x27\xe3\x99\xe5\xa1\x74\x2e\xc9\xba\xef"
    "\x92\xa1\x78\xe3\x7b\xd2\xd6\xb2\x21\xdf\x13\xfe\x2e\xca\x5d\x0c"
    "\x80\x80\x53\x17\x15\xc4\x88\x10\xb9\x61\xc9\x68\x84\x37\x3c\xd9"
    "\x15\xa1\x65\x3c\x26\x15\x9b\x8e\x3f\x29";
#else
    "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\x00\x45\x00"
    "\x05\x1c\x85\x8e\x40\x00\x40\x11\xb2\x40\x7f\x00\x00\x01\x7f\x00"
    "\x00\x01\xaf\x0a\x11\x51\x05\x08\x03\x1c\xc2\x00\x00\x00\x01\x08"
    "\x2a\x68\x59\x18\x78\xc8\x91\x4c\x08\xec\x73\x1b\x41\xa0\xd5\xc6"
    "\xfe\x00\x44\xe6\xb4\x85\x57\xdc\x28\xe4\xeb\x20\xaf\xd5\x1a\x3e"
    "\x33\x96\x63\xd2\x78\xcc\x85\x54\x13\xf7\xe8\x5b\xb8\x0f\xfb\xd9"
    "\xaf\x2a\xe0\xe1\xe7\x9a\xce\x60\x4b\x15\xaa\xe8\x0a\x63\x17\x00"
    "\x1b\x01\xf6\x25\x17\xd5\xd3\x61\x46\x7e\xd0\x15\xb2\x92\x40\x47"
    "\x0b\x4c\xfd\xed\x59\xcd\x19\x00\x2f\xb2\xe8\xad\xb9\xf8\x12\xc7"
    "\xbb\x53\x96\x9d\x25\xa4\x20\x65\x12\xd2\x4a\x70\xad\xc1\x19\xba"
    "\x02\x54\xf1\xa9\x22\x0a\x6f\x1f\x19\x4c\x81\x2a\x43\xf8\xf7\x86"
    "\x2d\x2f\x3b\x14\xfb\xf2\x70\xf9\xf8\x1b\xc2\x99\x70\x41\xcf\x95"
    "\x30\x91\x82\x6a\x94\x13\xcb\x75\xa5\xdc\xde\x79\x86\x16\x4c\xea"
    "\x56\x3b\xef\x6f\x00\xbd\xb5\xbc\x3b\xf6\xbc\xd3\x55\x01\xec\x6c"
    "\x71\x9c\xec\xdc\xdb\xbe\x53\xd0\xc7\x65\xc7\xf4\x90\x65\xd0\xed"
    "\x3c\xe0\xfa\x5d\x9e\xdd\x8c\xc0\x08\xa6\x08\x0e\xfb\x19\x60\xee"
    "\x74\x87\x01\x80\xa1\x71\xa9\xf4\xab\xf8\x59\xb1\x7b\xbc\x9b\x6e"
    "\x53\x6e\x98\x1f\x92\xdc\x18\xff\xc9\x4f\x08\xfb\x40\x39\x9e\x97"
    "\x14\x3f\x87\x0a\xff\x34\x15\xd4\x92\xf4\xa6\x6f\x99\xb9\xdc\x7a"
    "\xf9\x31\xa7\x03\xd9\xfe\x5a\x3e\x2c\x67\xc6\xe5\xfe\x49\x20\x30"
    "\x3e\xcb\x4d\xbb\xbe\xf3\xf9\x57\x91\x6d\x3a\x2b\x13\x96\x4a\x00"
    "\x6e\x6a\xb5\xde\xcd\x29\x67\xf1\x40\x94\x30\xd4\x17\xce\xd7\x85"
    "\x20\x02\xec\x51\x43\xcd\x11\x02\x13\x10\xbd\x43\xee\xb9\x79\x2d"
    "\x55\x85\x25\x77\xd6\x30\x10\xd8\x83\x99\x8c\xae\xe9\x10\x0d\x7f"
    "\xd8\x26\x50\x20\xf4\x3e\x11\x69\x85\xd9\x2f\x99\x8c\x0c\x68\x5a"
    "\xb1\x87\x29\x0b\x5e\x6a\x0c\x84\xb3\xdc\xcf\xd8\xb0\xa6\xeb\x21"
    "\x58\xd9\xdd\x33\x27\x65\x85\x25\xbc\x26\xb1\x70\xc0\xd3\x2d\xd0"
    "\x41\x0a\x78\x7b\x87\xa0\x90\x0f\xbd\xaf\x54\x1b\xd9\x19\x09\x77"
    "\x1e\xfe\xa5\x4f\xf3\xd4\x0d\xf7\xdc\x82\x89\x21\xf5\xa1\xc7\x52"
    "\xda\xfe\x9a\xec\x70\xa0\x69\xb2\x9c\xf0\xf7\x6a\xc8\xa5\xa1\x69"
    "\x28\x8e\x3d\x74\x30\x53\xb7\xee\xbe\xbc\x74\xaa\x7b\xca\x1d\xf2"
    "\x1c\xb8\x3b\x61\x97\xb8\xad\x1a\x1e\x03\x3f\x72\xa5\xde\x2f\x96"
    "\xc4\x42\x84\x2a\x36\x63\x8c\x15\x24\x21\xb6\x3a\x99\x65\x7b\x1f"
    "\xeb\xa2\x10\x99\xf0\xe0\xd3\x84\x33\xbf\x2f\xde\x79\x42\xb2\x96"
    "\xe6\x3d\x30\x0a\x05\x6c\x28\x03\x87\xb2\x3d\x59\x53\x61\x9a\x0f"
    "\x91\xcb\x95\x2d\x02\x6d\x9b\x01\x6e\x26\x9e\x47\xc0\xc1\xd0\xff"
    "\xf8\xe3\xe2\x8c\xc5\xb8\x9d\x13\xe7\xbf\xdc\x95\x5c\x48\xe1\xb4"
    "\x8b\x12\x70\x2e\x44\x4e\xff\xe2\xea\xaf\x17\x08\xaa\x5c\x4f\x4c"
    "\xb5\x97\x47\x6c\x54\x1e\xae\x33\x68\xcc\xbe\xc7\xe9\xff\x32\x6e"
    "\x95\x31\xcb\x66\x49\x69\xe9\xa3\x79\xfb\x54\x70\x8d\x3e\x7f\x05"
    "\xe4\x20\x82\x94\xdf\xde\x9d\x02\x48\x33\x6a\x90\x6b\x43\x84\xb5"
    "\x27\x5e\x52\xae\x1c\xfd\x2f\x70\xf5\x1d\xf5\xfd\x57\x9c\x90\xba"
    "\xa1\xb8\x19\x6d\x9e\x74\xc7\x36\xc3\xa7\x4a\x6d\x47\x18\xa6\xfd"
    "\xd9\x10\x7a\x90\x5a\xc1\x63\x7a\x3f\x59\xd2\x67\x41\x3d\xa8\xf1"
    "\x4c\x2c\xb3\x30\x0a\x78\xe1\x03\x3c\x18\xc7\x19\x5d\xef\x96\xfc"
    "\xf5\xe5\x7d\x7b\x26\x23\xdb\x74\x2c\x2c\x5c\xdc\x7f\x1f\xa9\xef"
    "\x25\x3b\x86\xc4\xc6\x9c\x45\x8e\x03\x8e\xb1\xf6\xfc\x2c\x68\x7b"
    "\x3f\xdb\xf7\x2a\x5a\xd8\xcf\x4e\xae\x02\x99\xe1\xa3\xdf\x89\xbd"
    "\xd7\x8a\xc0\x1d\x7f\xf4\xd4\xf0\xd7\x65\xf9\x6e\x90\x6f\x93\x21"
    "\x53\x13\x69\x5a\x85\x5f\x63\x8c\x0e\x83\x0d\x9c\xf1\xb0\xca\x37"
    "\xa3\x74\x7b\x44\xc1\xf1\x14\x92\xce\xde\x2e\x0c\xa6\x0c\x9d\x8c"
    "\x8d\x5d\xf2\x68\x4a\x1f\xe7\xb2\x16\xae\xa2\xd5\x94\x07\xa1\x84"
    "\x98\x77\x37\xb0\xf4\xa2\x85\x5d\xcf\x98\x2a\x38\x0a\xf4\xda\xbb"
    "\x65\xae\x3f\xcb\xe8\x25\x46\x34\x8b\xb4\x2a\x69\xe5\x8b\x99\x20"
    "\x3f\x26\x54\xf0\x89\x54\x30\x13\xea\xbb\x45\x00\x69\x76\x1a\xc7"
    "\x38\xc6\x4b\x9c\x0c\x8a\x08\xc4\xeb\x3a\xa2\x80\x9a\x2e\x93\x83"
    "\xe8\xb2\x4b\x36\x70\x65\x8c\x77\x80\xa8\x7c\x26\xf6\x95\xc4\xb0"
    "\x94\x45\x70\x14\x09\xe2\x91\x4b\x58\xbf\x51\xab\xf7\x07\x76\xfb"
    "\xa3\x3a\x68\x2b\x4e\xc9\x3f\xce\x26\xb8\x10\xbb\x18\xbe\x1c\x71"
    "\x2b\x53\xfc\x1d\x70\xa2\x7f\x96\xbf\xbc\x6f\x43\x00\x8e\xc3\x4e"
    "\x48\x62\xbe\x58\x45\x7e\xfb\x30\x98\xaf\x5a\x49\x5d\x9d\xc2\x37"
    "\x75\x8c\x07\xa1\x38\xea\x0b\xaf\xb0\x90\xce\xa2\x60\x2e\x70\x95"
    "\xbc\xcd\xd8\x19\x5a\xc3\xf8\x0b\x0f\xa1\x3c\x13\xa5\x2f\xe8\x07"
    "\x48\xa7\x96\xb6\x83\xaf\x12\x56\x22\xee\x1f\xdd\x37\x97\xfa\x7f"
    "\xe0\xa5\x0c\x91\xe9\x66\x08\xe4\x71\x02\x7d\x74\x73\x27\xea\xc7"
    "\x19\x51\x85\x4e\x42\x04\xaa\x43\x86\x12\xe7\x9b\x24\x15\x8b\x53"
    "\x98\x5e\x5b\x07\x2b\xf3\x90\x54\xef\x4c\xb1\xab\x55\x6a\x5b\xbb"
    "\x73\xae\xd3\x1d\x7e\xed\xdf\xe4\xc3\xc7\xf5\x9c\x87\x7c\x4c\x62"
    "\x51\x9a\x50\x7c\xb0\x78\x00\x19\xb4\xc3\x72\x69\x1e\x35\x4c\xfd"
    "\x19\x46\x4d\x39\x26\xaf\x03\x40\x69\x46\x91\x1e\x58\x39\x31\x1e"
    "\xee\x22\x18\x59\xa9\x1d\xbb\x83\x06\x44\x6b\x93\x8a\x41\xc0\xa0"
    "\x80\x0a\xcc\x3f\xc0\x9e\xc7\x2f\xa4\x45\x76\xc3\x5b\x32\x7c\xb2"
    "\x4f\xc7\x6a\xa4\x67\x81\x0b\xfc\x46\x79\x67\x44\x57\xea\x14\x6a"
    "\x54\x05\xf0\x47\x92\xeb\x1d\xdb\xf0\xe6\xa3\x49\x78\x3b\x16\xa3"
    "\x7a\x2b\x82\xbd\x68\xdb\x9c\x1d\x8b\x50\x64\xde\xad\xb2\x5c\x34"
    "\xed\x37\x99\x2b\x87\x47\x2e\x4b\x9c\xa5\xac\x85\x1b\xf9\x48\xbc"
    "\x3e\x0e\xe9\x50\xa5\x03\x88\xca\xea\x9b\x5e\xe7\x77\x72\xab\x96"
    "\x48\x40\xfb\x2c\xe1\x2d\xa0\x1d\xeb\x49\x09\x74\xae\x2d\xf8\x24"
    "\xf6\xde\xe6\x6a\xd8\x51\xc5\x7e\xef\x3e\x88\x44\x3e\x4e\xd3\x81"
    "\x36\x37\x5e\x88\x9d\x24\x67\x7b\x08\x51\x1f\x71\x63\xfd\x6e\xd0"
    "\x00\x1c\xee\xd4\x8e\xb9\x89\x64\xae\x1d\x15\x5f\x99\x97\xe0\x08"
    "\xc7\x28\x20\xce\xfc\x7d\x56\x78\x42\xb3\xc0\x5b\x1d\x1f\xbc\x1a"
    "\xa0\x64\x01\xf6\x52\x25\x5a\xbd\x4f\x52";
#endif

ulong pkt_full_sz = sizeof( pkt_full ) - 1;

